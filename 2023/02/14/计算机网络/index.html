



<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="やがて、平凡な人になる" href="http://sugarsbn.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="やがて、平凡な人になる" href="http://sugarsbn.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="やがて、平凡な人になる" href="http://sugarsbn.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  

<link rel="canonical" href="http://sugarsbn.github.io/2023/02/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">



  <title>
计算机网络 - - 计算机基础 |
SuBonan = やがて、平凡な人になる</title>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">计算机网络
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2023-02-14 19:32:36">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2023-02-14T19:32:36+08:00">2023-02-14</time>
  </span>
  <span class="item" title="Symbols count in article">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">Symbols count in article</span>
    <span>66k</span>
    <span class="text">words</span>
  </span>
  <span class="item" title="Reading time">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">Reading time</span>
    <span>1:01</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">SuBonan</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://i.imgtg.com/2023/01/12/Q5He6.png"></li>
          <li class="item" data-background-image="https://i.imgtg.com/2023/01/12/Q5LGP.png"></li>
          <li class="item" data-background-image="https://i.imgtg.com/2023/01/12/Q5dWs.jpg"></li>
          <li class="item" data-background-image="https://i.imgtg.com/2023/01/12/QUBUG.jpg"></li>
          <li class="item" data-background-image="https://ooo.0x0.ooo/2025/04/02/O0neEa.png"></li>
          <li class="item" data-background-image="https://i.imgtg.com/2023/01/12/Q5lrN.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" itemprop="item" rel="index" title="In - 计算机基础"><span itemprop="name">- 计算机基础</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-Hans">
  <link itemprop="mainEntityOfPage" href="http://sugarsbn.github.io/2023/02/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="SuBonan">
    <meta itemprop="description" content=", やがて、平凡な人になる <br><a target="_blank" rel="noopener" href="http://www.subonan.com/computer-graphics"> 图形学作业请点这里 </a>">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="やがて、平凡な人になる">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <p>It is the identity induction shows that the space of path starts at a fixed point is contractible</p>
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css">
<span id="more"></span>
<h2 id="第一章"><a class="markdownIt-Anchor" href="#第一章">#</a> 第一章</h2>
<ol>
<li>
<p>计算机网络的<strong>定义</strong>：</p>
<blockquote>
<p>A computer network is a collection of autonomous computers interconnected by a single technology.</p>
</blockquote>
</li>
<li>
<p>计算机网络硬件 (physical)、软件 (logical) 的约束：</p>
<blockquote>
<ul>
<li><strong>Hardware</strong>(Physical):</li>
<li>Personal Area Networks (PAN)</li>
<li>Local Area Networks (LAN)</li>
<li>Metropolitan Area Networks (MAN)</li>
<li>Wide Area Networks (WAN)</li>
<li>Internet works (internet)</li>
<li><strong>Software</strong>(Logical):</li>
<li>Layers: most networks are organized as a stack of layers or levels, each one built upon the one below it.</li>
<li>Protocols: describe how two communicating parties exchange information.</li>
<li>Services: describe what a network offers to parties that want to communicate.</li>
<li>Interfaces: describe how a client can make use of network services, i.e. how the services can be accessed.</li>
</ul>
</blockquote>
</li>
<li>
<p>计算机网络的<strong>分类</strong></p>
<blockquote>
<p>根据<strong>传输手段</strong>：Broadcast、Point-to-point</p>
<p>根据<strong>网络规模</strong>：PAN、LAN、MAN、WAN、internet</p>
<p><img data-src="1.png" alt="1"></p>
</blockquote>
</li>
<li>
<p><strong>Broadcast</strong> 特征：</p>
<blockquote>
<ul>
<li>Using <strong>a single communications channel</strong>.</li>
<li>The channel is shared.</li>
<li>Information sent from any one machine on the network is received by all other machines on the network.</li>
<li>Each piece of data received by a computer is checked to see whether it is addressed to that computer.</li>
<li>Broadcast networks allow data to be addressed to every machine on the network. This allows one machine to “<strong>broadcast</strong>” a message to all other machines.</li>
<li>It is possible to “broadcast” to a subset of the machines on the network. This is known as “<strong>multicasting</strong>”.</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Point-to-point</strong> 特征：</p>
<blockquote>
<ul>
<li>As a general rule, point-to-point is used in larger networks while broadcasting is used in smaller, geographically localized networks. There are exceptions.</li>
<li>Point-to-point is sometimes referred to as <strong>unicasting</strong>.</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>PAN</strong> 相关：</p>
<blockquote>
<ul>
<li>A network meant for one person.</li>
<li>A personal computer network:</li>
<li>a wireless keyboard and mouse</li>
<li>a networked printer</li>
<li>a PDA connection</li>
<li>Devices to control pacemakers</li>
<li>Remote controls for car stereos</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>LAN</strong> 相关：</p>
<p><img data-src="2.png" alt="2"></p>
</li>
<li>
<p><strong>WAN</strong> 相关：</p>
<blockquote>
<ul>
<li>A WAN spans a large geographical area, often a country or continent.</li>
<li>The user computers intended for running user (application) programs are called <strong>hosts</strong>.</li>
<li>Host computers are connected via a <strong>communication subnet</strong> to carry messages from host to host.</li>
<li>In most WANs, the subnet consists of <strong>transmission lines</strong> and <strong>switching elements (routers)</strong>.</li>
<li>Transmission lines move bits between machines.</li>
<li>They can be made of copper wire, optical fiber, or even radio links.</li>
<li>Most companies do not have transmission lines lying about, so instead they lease the lines form a telecommunications company.</li>
<li>A <strong>router</strong> is a specialized piece of switching hardware that connect two or more transmission lines and is responsible for determining the direction that data packets should be sent.</li>
<li>When data arrive on an incoming line, the switching element (router) must choose an outgoing line one which to forward them.</li>
<li>The routers will usually connect different kinds of networking technology.</li>
<li>Many WANs will in fact be <strong>internetworks</strong>, or composite networks that are made up of more than one network.</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Gateway</strong>:</p>
<blockquote>
<p>A kind of machine make the  different network connected and provide the necessary translation, both in terms of hardware and software.</p>
</blockquote>
</li>
<li>
<p><strong>internet</strong> &amp; <strong>subnet</strong>:</p>
<blockquote>
<ul>
<li>internet: internetworks</li>
<li>subnet: It makes the most sense <strong>in the context of a WAN</strong>, where it refers to the collection of routers and communication lines owned by the network operator.</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Internet</strong> 相关:</p>
<blockquote>
<ul>
<li>the best known network.</li>
<li>The worldwide Internet is a vast collection of different networks that use certain common protocols and provide certain common services.(<strong>hardware: internet</strong>)</li>
<li>The Internet runs according to the TCP/IP protocol. (<strong>software:TCP/IP</strong>)</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Layer</strong> 特征：</p>
<blockquote>
<ul>
<li>Each layer offers certain services to the higher layer.</li>
<li>Each layer shields the details of how the offered services are implemented.</li>
</ul>
</blockquote>
</li>
<li>
<p>why do we need a Network architecture? How about the networks realization structure?</p>
<blockquote>
<p>IDEA: Divide and Rule</p>
<ul>
<li>
<p>The networks are organized as a stack of layers.</p>
</li>
<li>
<p>Each layer builds upon the layer below it. The purpose of a layer is to offer services to the layer above it, shield the details of how the offered services are implemented.</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Protocol</strong> 简介：</p>
<blockquote>
<ul>
<li>
<p>A protocol is an agreement between the communicating parties on how communication is to proceed.</p>
</li>
<li>
<p>e.g. HTTP; FTP; TCP; IP; PPP.</p>
</li>
<li>
<p>Key factor:</p>
</li>
<li>
<p>Syntax: the format of data and control information.</p>
</li>
<li>
<p>Semantics: specific actions taken when messages received.</p>
</li>
<li>
<p>Synchronization: order of messages sent and received among network peers.</p>
</li>
<li>
<p>Entity: Any kind of software process, hardware devices, or even human beings, which can send or receive messages.</p>
</li>
<li>
<p>Peer: The entities comprising the corresponding layers on different machines. It is the peers that communicate by using the protocol to talk to each other.</p>
</li>
<li>
<p>Interface: defines which primitive operations and services the lower layer makes available to the upper one.</p>
<p>It locates between each pair of adjacent layers, also called as Service Access Point (SAP).</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Network Architecture</strong>:</p>
<blockquote>
<p>A set of layers and protocols is called a network architecture.</p>
</blockquote>
</li>
<li>
<p>Pros and Cons of Protocol Hierarchies</p>
<blockquote>
<p>Advantages:</p>
<ul>
<li>The function in each layer is independent. The adjacent layers are connected by interfaces.</li>
<li>Flexibility. The change of one layer would not influence other layers</li>
<li>Hierarchy Structure</li>
<li>The implementation and maintenance are both much easier. Reduce design complexity.</li>
<li>Standardization.</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>The more layers of the network protocol hierarchies get, the more spending are needed.</li>
<li>The network architecture using different protocol stacks can not communicate with each other.</li>
</ul>
</blockquote>
</li>
<li>
<p>Design Issues for the layers</p>
<blockquote>
<ul>
<li>Reliability: 差错控制、动态路由</li>
<li>The evolution of the network：addressing/naming，分段</li>
<li>Resource allocation：多路复用，流量控制</li>
<li>Network security</li>
</ul>
</blockquote>
</li>
<li>
<p>服务的分类：<strong>Connection-Oriented</strong> &amp; <strong>Connectionless</strong> Services</p>
<blockquote>
<ul>
<li>Connection-oriented: 三个阶段：Establish a connection, use the connection, release the connection. e.g. Phone system</li>
<li>Connectionless: 两个实体之间的通信不需要先建立好连接。 e.g. Postal System</li>
<li>Each kind of service can further be characterized by its <strong>reliability</strong>.</li>
<li>Usually, a reliable service is implemented by having the receiver <strong>acknowledge</strong> the receipt of each message so the sender is sure that it arrived.</li>
<li>The acknowledgement process introduces overhead and delays, which are often worth it but are sometimes undesirable.</li>
</ul>
</blockquote>
</li>
<li>
<p>服务原语 <strong>Service Primitives</strong>：</p>
<blockquote>
<ul>
<li>
<p>A service is formally specified by a set of primitives (operations) available to a user process to access the service.</p>
</li>
<li>
<p>Five service primitives for implementing a simple connection-oriented service:</p>
<p><img data-src="4.png" alt="4"></p>
</li>
<li></li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Reference Models</strong>:</p>
<blockquote>
<ul>
<li>
<p>Open Systems Interconnection (OSI) Reference Model: Although the protocols associated with <strong>the OSI model</strong> are not used any more, <strong>the model itself</strong> is actually quite general and still valid, and the features discussed at each layer are still very important.</p>
</li>
<li>
<p>Layers created for different abstractions.</p>
</li>
<li>
<p>Each layer performs well-defined function.</p>
</li>
<li>
<p>Function of layer chosen with definition of international standard protocols in mind.</p>
</li>
<li>
<p>Minimize information flow across interfaces between boundaries.</p>
</li>
<li>
<p>Number of layers optimum.</p>
</li>
</ul>
<p>The OSI model itself is not a network architecture because it does not specify the exact services and protocols to be used in each layer. It just tells what each layer should do.</p>
<p>However, ISO has also produced standards for all the layers, although these are not part of the reference model itself. Each one has been published as a separate international standard.</p>
<ul>
<li><strong>The TCP/IP model</strong> has the opposite properties: the model itself is not of much use but <strong>the protocols</strong> are widely used.</li>
</ul>
</blockquote>
</li>
<li>
<p>OSI 不同层简介：</p>
<blockquote>
<ul>
<li>
<p><strong>Physical Layer</strong>: The physical layer is concerned with transmitting raw <strong>bits</strong> over a communication channel. 透明的传送比特流，传送单位为比特</p>
</li>
<li>
<p>机械特性：<strong>指明接口所用接线器的形状和尺寸、引线数目和排列、固定和锁定装置等等。</strong></p>
</li>
<li>
<p>电气特性：<strong>指明在接口电缆的各条线上出现的电压的范围。</strong></p>
</li>
<li>
<p>功能特性：<strong>指明某条线上出现的某一电平的电压表示何种意义。</strong></p>
</li>
<li>
<p>过程特性：<strong>指明对于不同功能的各种可能事件的出现顺序。</strong></p>
</li>
<li>
<p><strong>Data link Layer</strong>: Deals with algorithms for achieving reliable, efficient communication between two adjacent machines at the data link layer. (point-to-point)  保证相邻结点链路上的可靠传输，传输单位为帧</p>
</li>
<li>
<p>Break up the data into data <strong>frames</strong>.</p>
</li>
<li>
<p>Link control: connection-oriented.</p>
</li>
<li>
<p>Error control : error-detecting and error-correcting.</p>
</li>
<li>
<p>Flow Control: keep a fast sender from swamping a slow receiver.</p>
</li>
<li>
<p><strong>Network Layer</strong>: The Network Layer controls the operation of the subnet. A key design issue is to determine how <strong>packets</strong> are routed from source to destination. 将传输层送来的报文进行分组，选择合适的路由，将分组按地址传送到目的主机。 传输单位为分组</p>
</li>
<li>
<p>To control the operation of the subnet.</p>
</li>
<li>
<p>Routing algorithm.</p>
</li>
<li>
<p>Error control.</p>
</li>
<li>
<p>Congestion control.</p>
</li>
<li>
<p><strong>Transport Layer</strong>:  Its task is to provide reliable, cost-effective data transport from the source to the destination <strong>(end-to-end)</strong>.</p>
</li>
</ul>
<p>A program on the source machine carries on a conversation with a similar program on the destination machine, using the <strong>message</strong> headers and control messages. 保证端到端的可靠传输，传输单位为报文</p>
<ul>
<li>
<p>Connection management.</p>
</li>
<li>
<p>Error control.</p>
</li>
<li>
<p>Congestion control.</p>
</li>
<li>
<p>QOS control. (Quality Of Service)</p>
</li>
<li>
<p><strong>Session Layer</strong>: The session layer allows users on different machines to establish sessions between them. 允许不同机器的用户建立会话关系</p>
</li>
<li>
<p>Dialog control：记录该由谁来传输数据不参与具体的数据传输，对数据传输进行管理。即在两个互相通信的进程中建立、组织、协调交互</p>
</li>
<li>
<p>Synchronization：在数据流中插入检查点，当网络崩溃时，仅传输最后一个检查点以后的数据</p>
</li>
<li>
<p>Token management: 令牌管理。禁止双方同时执行同一个关键操作。</p>
</li>
<li>
<p><strong>Presentation Layer</strong>: The presentation layer is concerned with the syntax and semantics of the information transmitted. 主要解决经常被用户请求的通用功能，如传输数据的表示解释，包括格式转换、编码、压缩、加密等</p>
</li>
<li>
<p>According to the users’ need , to make the corresponding change. For instance, data encoding and data encryption. 不同的计算机有不同的内部数据表示，表示层转换为本机可以理解的格式</p>
</li>
<li>
<p><strong>Application Layer</strong>:  The application layer is the interface between user and the network. It contains a variety of protocols that are commonly needed by the users.  应用层是用户和网络的接口，包含人们普遍需要的多种协议。</p>
</li>
<li>
<p>To provide services to the users not for the upper layer. 不是为上层提供服务，而是直接为最终用户进程提供应用服务</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>TCP/IP Model 不同层简介：</p>
<blockquote>
<ul>
<li><strong>Link Layer</strong>: It describes what links such as serial lines and classic Ethernet must do to meet the needs of the connectionless internet layer. Protocol is not defined. <strong>It is not really a layer at all, in the normal sense of the term, but rather an interface between hosts and transmission links.</strong></li>
<li><strong>Internet Layer</strong>:</li>
<li>Key part in TCP/IP Model</li>
<li>To permit hosts to inject <strong>packets</strong> into any network and have them travel independently to the destination</li>
<li>A “best effort” connectionless service: Packets might be lost, Packets might arrive out of order</li>
<li><strong>Transport Layer</strong>:</li>
<li>Concerned with <strong>end-to-end</strong> data transfer between end systems (hosts)</li>
<li>Transmission unit is called segment/user datagram</li>
<li>TCP/IP networks such as the Internet provides two types of services to applications:
<ul>
<li>connection-oriented” service – Transmission control Protocol (TCP)</li>
<li>“connectionless” service - User Datagram Protocol (UDP)</li>
</ul>
</li>
<li><strong>Application Layer</strong>:</li>
<li>Containing all the higher-level protocols</li>
<li>Examples include: HTTP, FTP,Telnet(virtual terminal), SMTP, DNS</li>
</ul>
</blockquote>
</li>
<li>
<p>TCP/IP 协议簇：</p>
<p><img data-src="5.png" alt="5"></p>
</li>
<li>
<p>OSI 和 TCP/IP Model 的比较：</p>
<blockquote>
<p>Similarities:</p>
<ul>
<li>Both are based on the concept of a stack of independent protocols 基于独立的协议栈的概念。</li>
<li>The functionality of the layers are roughly similar. 层的功能也大体相似</li>
<li>The layers below transport layer are all communication-oriented, while the layers above transport layer are all application-oriented. 传输层以下都是面向通信的，而传输层以上都是面向用户的。</li>
</ul>
<p>Differences:</p>
<ul>
<li>
<p>The OSI model clearly distinguishes between service, interface and protocol. But TCP/IP does not.  OSI 明确定义了服务、接口、协议 3 个概念。</p>
</li>
<li>
<p>The protocols in the OSI model are better hidden than in the TCP/IP model. OSI 中的协议具有更好的隐藏性。</p>
</li>
<li>
<p>The number of layers is different. 层的数量不同。</p>
</li>
<li>
<p>OSI model supports both Connectionless and connection-oriented communication in the network layer, but only connection-oriented communication in the transport layer.</p>
</li>
</ul>
<p>TCP/IP model supports only connectionless communication in the network layer, but supports both modes in the transport layer.</p>
</blockquote>
</li>
<li>
<p>OSI 和 TCP/IP Model 的缺点：</p>
<blockquote>
<p>OSI:</p>
<ul>
<li>Arrived late on the scene.</li>
<li>Model was too complex and the protocols were flawed (some stuff appears in multiple levels)</li>
<li>Poor implementation (no good example)</li>
<li>Poorly marketed</li>
</ul>
<p>TCP/IP:</p>
<ul>
<li>
<p>没有明确区分服务、接口和协议的概念</p>
</li>
<li>
<p>不通用，不适合描述 TCP/IP 之外的任何其他协议栈</p>
</li>
<li>
<p>链路层不是通常意义上的层，只是一个接口（网络层和数据链路层间的）</p>
</li>
<li>
<p>没有区分物理层和数据链路层</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>网络的例子：Internet、Ethernet、WLAN</p>
<blockquote>
<p><strong>Internet</strong>(internet): Hardware: internet, router, Software: TCP/IP</p>
<p><strong>Ethernet</strong>(LAN): Hardware: wired, hub/switch, Software: IEEE802.3(DIX)</p>
<p><strong>WLAN</strong>(LAN): Hardware: wireless, AP, Software: IEEE802.11 (WiFi)</p>
</blockquote>
</li>
</ol>
<h2 id="第二章-physical-layer"><a class="markdownIt-Anchor" href="#第二章-physical-layer">#</a> 第二章 Physical Layer</h2>
<ol>
<li>
<p>Theoretical Basis for Data Communication</p>
<p><img data-src="6.png" alt="6"></p>
</li>
<li>
<p><strong>Performance</strong>:</p>
<blockquote>
<ul>
<li>
<p><strong>(analog) Bandwidth</strong>(Hz):  the range of frequencies contained in a composite signal or the <strong>range</strong> of frequencies a channel can pass.</p>
</li>
<li>
<p><strong>(digital) Bandwidth</strong>(bits/seconds): the number of bits per second that a channel, a link, or even a network can transmit.</p>
</li>
<li>
<p><strong>Data rate</strong> is the end result of using the analog bandwidth of a physical channel for digital transmission, and the two are related.</p>
</li>
<li>
<p>Nyquist’s theorem: Maximum data rate=<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>B</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>V</mi></mrow><annotation encoding="application/x-tex">2Blog_2V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> bits/second. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> is the bandwidth(Hz), <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> is number of valid states.</p>
</li>
<li>
<p>Shannon’s formula: the capacity for a noisy channel maximum number of bits/sec=<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>S</mi><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Blog_2(1+S/N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> is the energy of channel and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is the energy of noise.</p>
</li>
<li>
<p><strong>Throughput</strong>: The throughput is a measure of how fast we can actually send data through a network.</p>
</li>
<li>
<p>吞吐量表示在单位时间内通过某个网络（或信道、接口）的数据量</p>
</li>
<li>
<p>吞吐量更经常地用于对现实世界中的网络的一种测量，以便知道实际上到底有多少数据量能够通过网络。</p>
</li>
<li>
<p>吞吐量受网络的带宽或网络的额定速率的限制。</p>
</li>
<li>
<p><strong>Delay</strong>:</p>
</li>
<li>
<p>Transmission Delay: 发送数据时，数据帧从结点进入到传输媒体所需要的时间。为数据帧长度除以发送速率。</p>
</li>
<li>
<p>Propagation Delay:  电磁波在信道中需要传播一定的距离而花费的时间。为信道长度除以信道中信号传播速率。</p>
</li>
<li>
<p>Processing Delay: 交换结点为存储转发而进行一些必要的处理所花费的时间。</p>
</li>
<li>
<p>Queuing Delay: 结点缓存队列中分组排队所经历的时延。排队时延的长短往往取决于网络中当时的通信量。</p>
</li>
<li>
<p><strong>Latency</strong>=Transmission Delay + Propagation Delay + Processing Delay + Queuing Delay.</p>
</li>
<li>
<p><strong>Bandwidth-Delay Product</strong> (时延带宽积): The bandwidth-delay product defines the number of bits that can fill the link. 链路的时延带宽积又称为以比特为单位的链路长度。 为 Propagation Delay 乘以 Bandwidth</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Transmission Media</strong></p>
<blockquote>
<p>Guided Transmission Media: Magnetic media, Twisted pairs, Coaxial cabal, Power lines, Fiber optics.</p>
<p>Wireless Transmission: Electromagnetic Spectrum, Radio Transmission, Microwave Transmission, Infrared Transmission, Light Transmission.</p>
</blockquote>
</li>
<li>
<p>Digital Modulation</p>
<blockquote>
<p><img data-src="7.png" alt="7"></p>
<p>Digital signals Transmission for analog data</p>
<ul>
<li>Pulse Code Modulation</li>
</ul>
<p>Digital signals Transmission for digital data</p>
<ul>
<li>nonreturn-to zero encoding</li>
<li>Manchester encoding</li>
<li>differential Manchester encoding</li>
</ul>
<p>Analog signals Transmission for digital data</p>
<ul>
<li>ASK(Amplitude Shift Keying)</li>
<li>FSK(Frequency Shift Keying)</li>
<li>PSK(Phase Shift Keying)</li>
<li>QPSK(Quadrature Phase Shift Keying)</li>
</ul>
</blockquote>
</li>
<li>
<p>Baseband Transmission &amp; Passband Transmission</p>
<blockquote>
<p><img data-src="8.png" alt="8"></p>
<p><img data-src="9.png" alt="9"></p>
</blockquote>
</li>
<li>
<p><strong>Multiplexing</strong>:</p>
<blockquote>
<p>Frequency Division Multiplexing:</p>
<p><img data-src="10.png" alt="10"></p>
<p>Time Division Multiplexing:</p>
<p><img data-src="11.png" alt="11"></p>
<p>Code Division Multiplexing</p>
<p><img data-src="12.png" alt="12"></p>
</blockquote>
</li>
<li>
<p>Structure of the Telephone System</p>
<blockquote>
<ul>
<li>Each house has a line connecting it to the nearest end office（端局） of the phone company.</li>
<li>The end offices are connected to toll offices（长途局）, which are connected to an intermediate switching office（中心交换局）.</li>
<li>Any connection between two phones must be switched at one of these levels.</li>
</ul>
<p><img data-src="13.png" alt="13"></p>
<ul>
<li>Local loops (本地回路) : analog twisted pair going to house and businesses.</li>
<li>Trunks （干线 / 中继线）: digital fiber optics connecting the switching offices.</li>
<li>Switching Offices（交换局） : where calls are moved from one trunk to another.</li>
</ul>
<p><img data-src="14.png" alt="14"></p>
</blockquote>
</li>
<li>
<p>Architecture of the Internet</p>
<blockquote>
<p><img data-src="15.png" alt="15"></p>
<ul>
<li>The Internet is a network of networks.</li>
<li>Each individually administrated network is called an <strong>Autonomous System</strong> (AS).</li>
<li>We can roughly divide the networks into <strong>access networks</strong> and <strong>transit networks</strong>.</li>
</ul>
</blockquote>
</li>
<li>
<p>Accessing the Internet</p>
<blockquote>
<p>Using telephone networks:</p>
<ul>
<li>
<p>Dial-up (拨号)(narrowband):</p>
</li>
<li>
<p>Modems (调制解调器): convert the digital data to analog form for transmission over the local loop or the reverse conversion (at computer side)</p>
</li>
<li>
<p>Codecs（编解码器）: convert the analog to digital for transmission over long-haul fiber trunks or the reverse conversion (at the end office)</p>
</li>
</ul>
<p><img data-src="16.png" alt="16"></p>
<ul>
<li>Digital Subscriber Lines (DSL)(数字用户线)(broadband): 将 1.1MHz 的频谱分成 256 个信道，每个信道 4KHz:</li>
</ul>
<p><img data-src="17.png" alt="17"></p>
<p>Operation of ADSL（Asymmetric DSL) using discrete multitone modulation（DMT）</p>
<p>A typical ADSL equipment configuration:</p>
<p><img data-src="18.png" alt="18"></p>
<ul>
<li>Fiber to the home: Passive optical network(<strong>无源光网络</strong>，PON) for Fiber To The Home.</li>
</ul>
<p><img data-src="19.png" alt="19"></p>
<ul>
<li>Using Community Antenna Television system</li>
</ul>
<p><img data-src="20.png" alt="20"></p>
<ul>
<li>Internet over Cable: Hybrid fiber-coaxial (HFC) network</li>
</ul>
<p><img data-src="21.png" alt="21"></p>
</blockquote>
</li>
<li>
<p>SONET/SDH</p>
<blockquote>
<p>SONET/SDH 定义了一组在<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlODUlODklRTclQkElQTQvMTcxNjMyP2Zyb21Nb2R1bGU9bGVtbWFfaW5saW5r">光纤</span>上传输光信号的速率和格式，采用<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS9URE0vNTQ5NTYzNz9mcm9tTW9kdWxlPWxlbW1hX2lubGluaw=="> TDM</span> 技术。</p>
<p><img data-src="22.png" alt="22"></p>
</blockquote>
</li>
<li>
<p>Switching</p>
<blockquote>
<p><img data-src="23.png" alt="23"></p>
<ul>
<li>
<p>“交换”(switching) 的含义就是转接 — 把一条电话线转接到另一条电话线，使它们连通起来。</p>
</li>
<li>
<p>从通信资源的分配角度来看，“交换” 就是按照某种方式动态地分配传输线路的资源。</p>
</li>
</ul>
<p>电路交换：connection-oriented，三个阶段：建立连接、通信、释放连接。计算机数据具有突发性，这导致通信线路的利用率很低。</p>
<p>分组交换：packet 传输路径可能不同。</p>
<p><img data-src="24.png" alt="24"></p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Circuit Switched</th>
<th>Packet Switched</th>
</tr>
</thead>
<tbody>
<tr>
<td>Call Setup</td>
<td>Required</td>
<td>Not required</td>
</tr>
<tr>
<td>Dedicated physical path</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Each packet follows the same route</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Is a switch crash fatal</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Bandwidth available</td>
<td>Fixed</td>
<td>Dynamic</td>
</tr>
<tr>
<td>Time of possible congestion</td>
<td>At setup time</td>
<td>On every packet</td>
</tr>
<tr>
<td>Potentially wasted bandwidth</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Store and forward transmission</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>Charging</td>
<td>Per minute</td>
<td>Per packet</td>
</tr>
<tr>
<td>Packets arrive in order</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody>
</table>
</blockquote>
</li>
</ol>
<h2 id="第三章-data-link-layer"><a class="markdownIt-Anchor" href="#第三章-data-link-layer">#</a> 第三章 Data Link Layer</h2>
<ol>
<li>
<p>Function of Data Link Layer</p>
<blockquote>
<p>The data link layer deals with the algorithms for achieving reliable, efficient communication of whole units of information called frames between two adjacent machines.  研究两个相邻机器在数据链路层进行可靠、有效的数据帧通信</p>
</blockquote>
</li>
<li>
<p>Data Link Layer 设计要点</p>
<blockquote>
<ul>
<li>Provide a well-defined service interface to the network layer（Framing）</li>
<li>Dealing with transmission errors（Error control）</li>
<li>Regulating data flow of data so that slow receivers not swamped by fast senders（Flow control）</li>
</ul>
</blockquote>
</li>
<li>
<p>Virtual Data Path &amp; Actual Data Path</p>
<blockquote>
<p><img data-src="25.png" alt="25"></p>
</blockquote>
</li>
<li>
<p>Possible Services Offered</p>
<blockquote>
<p><strong>Unacknowledged connectionless service</strong>: The source machine sends independent frames to the destination machine without having the destination acknowledge them.</p>
<ul>
<li><strong>Low error rate</strong> <strong>scenario</strong>: recovery is left to higher layers.</li>
<li><strong>Real-time traffic</strong>: late data are worse than bad data.</li>
<li><strong>Ethernet</strong> is a good example of a data link layer that provides this class of service. No logical connection is established beforehand and released afterward.</li>
</ul>
<p>Acknowledged connectionless service.</p>
<ul>
<li>There are no logical connections used, but each frame sent is individually acknowledged.</li>
<li>The sender knows whether a frame has arrived correctly or been lost. If it has not arrived within a specified time interval, it can be sent again.</li>
<li>This service is useful over unreliable channels.</li>
<li><strong>802.11</strong> (WiFi) is a good example of this class of service.</li>
</ul>
<p>Acknowledged connection-oriented service.</p>
<ul>
<li>Three phases: establish the connection, transfer data, release the connection.</li>
<li>Each frame sent over the connection is numbered, and the data link layer guarantees that each frame sent is indeed received.</li>
<li>It guarantees that each frame is received exactly once and that all frames are received in the right order.</li>
<li>It is appropriate over long, unreliable links such as a satellite channel or a long-distance telephone circuit.</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Framing</strong>:</p>
<blockquote>
<p>The Physical Layer is only able to put a raw bit stream on the transmission media, We have to be able to break up the bit stream into discrete frames.</p>
<p>Two problems to solve:</p>
<ul>
<li>帧的边界问题（boundary）</li>
<li>帧的透明传输（填充）问题 (stuffing)</li>
</ul>
<p>Methods:</p>
<ul>
<li>
<p>Byte count (字节计数法)</p>
</li>
<li>
<p>This method uses a field in the header to specify the number of bytes in the frame.（在帧头部用一个字段来标明帧内字节数）</p>
</li>
<li>
<p>This method can cause problems if the count is garbled in transit.（可能出现由于传输差错而被篡改）</p>
</li>
<li>
<p>The receiver will not know where to pick up and the sender will not know how much to resend.</p>
</li>
<li>
<p>This method is rarely used anymore.</p>
</li>
<li>
<p>Flag bytes with byte stuffing (字节填充的标志字节法)</p>
</li>
<li>
<p>Frames begin and end with special bytes（Flag Byte 标志字节）.</p>
</li>
<li>
<p>Often used are the same start/end flag.</p>
</li>
<li>
<p>If the receiver loss of synchronization, it just looks for two consecutive flag bytes to denote the end of one frame and the start of the next.</p>
</li>
<li>
<p>What happens if the flag byte accidentally occurs in the data?</p>
<p>Byte stuffing is the process of inserting an special escape byte (ESC) just before each accidental flag byte in the data.</p>
<p>What happens if an ESC accidentally occurs in the middle of the data? It is stuffed with an escape byte too.</p>
<p>This is sometimes referred to as <strong>character stuffing</strong>.（字符填充）</p>
<p>Example used in PPP protocol:</p>
<p><img data-src="26.png" alt="26"></p>
</li>
<li>
<p>Flag bits with bit stuffing (比特填充的标志比特法)</p>
</li>
<li>
<p>Framing can be done at the bit level, so frames can contain an arbitrary number of bits made up of units of any size.</p>
</li>
<li>
<p>Each frame begins and ends with a special bit pattern, <strong>01111110</strong> (<strong>0x7E</strong> in hexadecimal)</p>
</li>
<li>
<p>Bit stuffing: 在发送端，只要发现有 5 个连续 1, 则立即填入一个 0。</p>
</li>
<li>
<p>接收端对帧中的比特流进行扫描，每当发现 5 个连续 1 时就把这 5 个连续 1 后的一个 0 删除。</p>
</li>
<li>
<p>主要用于 HDLC（高级数据链路控制）</p>
</li>
<li>
<p>Physical layer coding violations (物理层编码违例法)</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Error Control</strong>:</p>
<blockquote>
<p>How to make sure all frames are eventually delivered to the network layer at the destination and in the proper order?</p>
<ul>
<li>Q: Suppose something went wrong during frame transmission. How do we actually notice that something is wrong, and can it be corrected by the receiver?</li>
</ul>
<p>A: Acknowledgment, Error Detection and Error Correction</p>
<ul>
<li>Q: Suppose the packet was lost on the way. How do the sender notice it?</li>
</ul>
<p>A: Timers and Retransmission</p>
<ul>
<li>Q: How to do if a frame was transmitted multiple times?</li>
</ul>
<p>A: Sequence Numbers for each frame.</p>
<p>使用上述的确认和重传机制，我们就可以在不可靠的传输网络上实现可靠的通信。</p>
<p>这种可靠传输协议常称为自动重传请求 ARQ (Automatic Repeat reQuest)。ARQ 表明重传的请求是自动进行的。接收方不需要请求发送方重传某个出错的分组。只要超时没有收到接收方的 acknowledgement，发送方就会自动重传。</p>
</blockquote>
</li>
<li>
<p><strong>Flow Control</strong>:</p>
<blockquote>
<p>To solve the problem that a sender wants to transmit frames faster than the receiver can accept them.</p>
<ul>
<li>Feedback-based flow control: feedback is used to tell the sender how the receiver is doing or to send another frame, and used in data link layer or higher layers.</li>
<li>Rate-based flow control: 限制发送方的发送数据的速率，seen as part of the transport layer.</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Error Detection and Correction</strong>:</p>
<blockquote>
<p>Types of errors: Single bit errors, Burst errors.</p>
<p>Basic strategies for dealing with errors:</p>
<ul>
<li>Error-correcting codes (FEC)</li>
</ul>
<p><strong>Forward Error Correction</strong>: to include enough redundant information along with each block of data sent (error-correcting codes), to enable the receiver to deduce what the transmitted data must have been.</p>
<ul>
<li>Error-detecting codes</li>
</ul>
<p><strong>Error detection and Retransmission</strong>: to include only enough redundancy to allow the receiver to deduce that an error occurred, but not which error (error-detecting codes), and have it request a retransmission.</p>
<ul>
<li>Automatic Repeat reQuest (ARQ)</li>
</ul>
</blockquote>
</li>
<li>
<p>Terms:</p>
<blockquote>
<ul>
<li>A frame consists of <em>m</em> data (i.e. message) bits and <em>r</em> redundant (i.e. check) bits.</li>
<li><strong>In a block code</strong>, the <em>r</em> check bits are computed solely as a function of the m data bits with which they are associated.</li>
<li><strong>In a systematic code</strong>, the <em>m</em> data bits are sent directly, along with the check bits, rather than being encoded themselves before they are sent.</li>
<li><strong>In a linear code</strong>, the <em>r</em> check bits are computed as a linear function of the m data bits. Exclusive OR (XOR) or modulo 2 addition is a popular choice.</li>
<li>An n-bit unit containing data and check bits is referred to as an <strong>n-bit codeword.</strong></li>
<li>The <strong>code rate</strong> is the fraction of the codeword that carries information that is not redundant, or m/n.</li>
<li>The number of bit positions in which two codewords differ is called Hamming distance.</li>
</ul>
</blockquote>
</li>
<li>
<p><strong>Error-Correcting Codes</strong>:</p>
<blockquote>
<p>Hamming Codes:</p>
<p>Binary convolutional codes (二进制卷积码)</p>
<p>Reed-Solomon codes (里德所罗门码)</p>
<p>Low-density parity check codes (低密度奇偶校验码)</p>
</blockquote>
</li>
<li>
<p><strong>Error-Detecting Codes</strong>:</p>
<blockquote>
<p>Parity (奇偶校验)</p>
<ul>
<li>Interleaving of parity bits to detect a burst error:</li>
</ul>
<p><img data-src="27.png" alt="27"></p>
<p>Checksums (检验和)</p>
<ul>
<li>
<p>Concept: a group of check bits associated with a message, regardless of how are calculated.</p>
</li>
<li>
<p>At the source, the message is first divided into m-bit unit called checksum, which is sent with the message.</p>
</li>
</ul>
<p>At the destination, the checker creates a new checksum from the combination of the message and sent checksum. If the new checksum is all 0s, the message is accepted; otherwise, the message is discarded.</p>
<ul>
<li>
<p>Note that in the real implementation, the checksum unit is not necessarily added at the end of message; it can be inserted in the middle of the message.</p>
</li>
<li>
<p>The Internet Checksum, used in IP, TCP, UDP:</p>
</li>
</ul>
<p><img data-src="28.png" alt="28"></p>
<p>Cyclic Redundancy Checks (CRC, 循环冗余校验)</p>
<ul>
<li>
<p>One of the most common and powerful error-detecting codes</p>
</li>
<li>
<p>Given a <em>k</em> bit block of bits, the transmitter generates an (<em>n – k)</em> bit frame check sequence (FCS) which is exactly divisible by some predetermined number.</p>
</li>
<li>
<p>Receiver divides the incoming frame by that number.</p>
</li>
<li>
<p>A checksum is generated for the message. The checksum, when divided by the <strong>generator polynomial</strong>, will have no remainder. If a remainder exists, then there has been an error in transmission.</p>
</li>
</ul>
<p>CRC-16 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mn>16</mn></msup><mo>+</mo><msup><mi>X</mi><mn>15</mn></msup><mo>+</mo><msup><mi>X</mi><mn>2</mn></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X^{16}+X^{15}+X^2+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> (USB)</p>
<p>CRC-ITU <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mn>16</mn></msup><mo>+</mo><msup><mi>X</mi><mn>12</mn></msup><mo>+</mo><msup><mi>X</mi><mn>5</mn></msup><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X^{16}+X^{12}+X^5+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> (HDLC, PPP)</p>
<p>CRC-32</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>X</mi><mn>32</mn></msup><mo>+</mo><msup><mi>X</mi><mn>26</mn></msup><mo>+</mo><msup><mi>X</mi><mn>23</mn></msup><mo>+</mo><msup><mi>X</mi><mn>22</mn></msup><mo>+</mo><msup><mi>X</mi><mn>16</mn></msup><mo>+</mo><msup><mi>X</mi><mn>12</mn></msup><mspace linebreak="newline"></mspace><mo>+</mo><msup><mi>X</mi><mn>11</mn></msup><mo>+</mo><msup><mi>X</mi><mn>10</mn></msup><mo>+</mo><msup><mi>X</mi><mn>8</mn></msup><mo>+</mo><msup><mi>X</mi><mn>7</mn></msup><mo>+</mo><msup><mi>X</mi><mi>T</mi></msup><mo>+</mo><msup><mi>X</mi><mn>4</mn></msup><mo>+</mo><msup><mi>X</mi><mn>2</mn></msup><mo>+</mo><mi>X</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">X^{32}+X^{26}+X^{23}+X^{22}+X^{16}+X^{12}\\+X^{11}+X^{10}+X^8+X^7+X^T+X^4+X^2+X+1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord">+</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9746609999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>(LANS, PPP)</p>
<ul>
<li>
<p>Example: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>X</mi><mn>4</mn></msup><mo>+</mo><mi>X</mi><mo>+</mo><mn>1</mn><mo>=</mo><mn>10011</mn></mrow><annotation encoding="application/x-tex">G(x)=X^4+X+1=10011</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">1</span><span class="mord">1</span></span></span></span>. Then we add <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mi>g</mi><mi>r</mi><mi>e</mi><mi>e</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">)</mo><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">degree(G)=4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span> 0s to the end of data, and divide it by 10011:</p>
<p><img data-src="29.png" alt="29"></p>
</li>
</ul>
<p>The receiver would just divide the Data+Remainder by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span>, if there is no remainder, then the data is transmitted correctly.</p>
</blockquote>
</li>
<li>
<p><strong>Elementary Data Link Protocols</strong>:</p>
<blockquote>
<p>MAX_PKT : 定义一个帧允许的最大字节数</p>
<p>seq_nr: 整数，帧的编号， 0≤seq_nr≤MAX_SEQ</p>
<p>packet：同一台机器的网络层与数据链路层之间或相互通信的两个机器的网络层对等实体间交换的信息单元</p>
<p>帧的组成：</p>
<p>kind：指出帧中是否有数据。有的帧是控制帧，有的帧是包含了控制信息的数据帧</p>
<p>seq：用于帧的序号</p>
<p>ack：对帧进行确认的编号</p>
<p>info：数据帧的 info 就是网络层传下来的的分组；  控制帧的 info 字段无用</p>
</blockquote>
</li>
<li>
<p><strong>Utopian Simplex Protocol</strong>:</p>
<blockquote>
<p>Suppose:</p>
<ul>
<li>Data are transmitted in one direction only;</li>
<li>Both the transmitting and receiving network layers are always ready;</li>
<li>Processing time can be ignored;</li>
<li>Infinite buffer space is available;</li>
<li>The communication channel between the data link layers never damages or loses frames.</li>
</ul>
<p>Sender:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   &gt;<span class="function"><span class="type">void</span> <span class="title">sender</span><span class="params">()</span></span>&#123;</span><br><span class="line">frame s;</span><br><span class="line">   packet buffer;</span><br><span class="line">   <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">       <span class="built_in">from_network_layer</span>(&amp;buffer);</span><br><span class="line">       s.info = buffer;</span><br><span class="line">       <span class="built_in">to_physical_layer</span>(&amp;s);</span><br><span class="line">   &#125;</span><br><span class="line">   &gt;&#125;</span><br></pre></td></tr></table></figure>
<p>Receiver:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   &gt;<span class="function"><span class="type">void</span> <span class="title">receiver</span><span class="params">()</span></span>&#123;</span><br><span class="line">frame r;</span><br><span class="line">event_type event;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">	<span class="built_in">wait_for_event</span>(&amp;event); <span class="comment">// wait for frame arrive</span></span><br><span class="line">	<span class="built_in">from_physical_layer</span>(&amp;r);</span><br><span class="line">	<span class="built_in">to_network_layer</span>(&amp;r.info);</span><br><span class="line">&#125;</span><br><span class="line">   &gt;&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li>
<p><strong>Simplex Stop-and-Wait Protocol for an Error-Free Channel</strong></p>
<blockquote>
<p>Drop the most unrealistic restriction used in Utopian Simplex Protocol i.e. Infinite buffer space is available. (去掉缓冲区空间无穷大的条件)</p>
<p>How to prevent the sender from flooding the receiver with data faster than the latter is able to process them?</p>
<ul>
<li>A general solution to it is to have the receiver provide feedback to the sender. (a little dummy frame)</li>
<li>Protocol in which the sender sends one frame and then waits for an acknowledgement before proceeding are called stop-and-wait.</li>
</ul>
<p>Sender:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt;<span class="function"><span class="type">void</span> <span class="title">sender</span><span class="params">()</span></span>&#123;</span><br><span class="line">frame s;</span><br><span class="line">packet buffer;</span><br><span class="line">event_type event;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">    <span class="built_in">from_network_layer</span>(&amp;buffer);</span><br><span class="line">    s.info = buffer;</span><br><span class="line">    <span class="built_in">to_physical_layer</span>(&amp;s);</span><br><span class="line">    <span class="built_in">wait_for_event</span>(&amp;event); <span class="comment">// Do not proceed until given the &quot;go ahead&quot;.</span></span><br><span class="line">&#125;</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure>
<p>Receiver:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   &gt;<span class="function"><span class="type">void</span> <span class="title">receiver</span><span class="params">()</span></span>&#123;</span><br><span class="line">frame r, s;</span><br><span class="line">   event_type event;</span><br><span class="line">   <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">       <span class="built_in">wait_for_event</span>(&amp;event);</span><br><span class="line">       <span class="built_in">from_physical_layer</span>(&amp;r);</span><br><span class="line">       <span class="built_in">to_network_layer</span>(&amp;r.info);</span><br><span class="line">       <span class="built_in">to_physical_layer</span>(&amp;s); <span class="comment">// send the &quot;go ahead&quot; dummy frame to sender.</span></span><br><span class="line">   &#125;</span><br><span class="line">   &gt;&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li>
<p><strong>Simplex Stop-and-Wait Protocol for a noisy Channel</strong>:</p>
<blockquote>
<p>Now let us consider the normal situation of a communication channel that makes errors. Frames may be either damaged or lost completely.</p>
<p>Q: A sender does not know whether a frame has made it (correctly) to the receiver.</p>
<p>A: let the receiver acknowledge undamaged frames.</p>
<p>Q: Frame (acknowledgments) may get lost.</p>
<p>A: let the sender use a timer by which it simply retransmits unacknowledged frames after some time.</p>
<p>Q: The receiver cannot distinguish duplicate transmissions.</p>
<p>A: use sequence numbers.</p>
<p>Sender:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   &gt;<span class="function"><span class="type">void</span> <span class="title">sender</span><span class="params">()</span></span>&#123;</span><br><span class="line">seq_nr next_frame_to_send;</span><br><span class="line">   frame s;</span><br><span class="line">   packet buffer;</span><br><span class="line">   event_type event;</span><br><span class="line">   </span><br><span class="line">   next_frame_to_send = <span class="number">0</span>;</span><br><span class="line">   <span class="built_in">from_network_layer</span>(&amp;buffer);</span><br><span class="line">   <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">       s.info = buffer;</span><br><span class="line">       s.seq = next_frame_to_send;</span><br><span class="line">       <span class="built_in">to_physical_layer</span>(&amp;s);</span><br><span class="line">       <span class="built_in">start_timer</span>(s.seq);</span><br><span class="line">       <span class="built_in">wait_for_event</span>(&amp;event);</span><br><span class="line">       <span class="keyword">if</span> (event == frame_arrival)&#123;</span><br><span class="line">           <span class="built_in">from_physical_layer</span>(&amp;s);</span><br><span class="line">           <span class="keyword">if</span> (s.ack == next_frame_to_send)&#123;</span><br><span class="line">			<span class="built_in">stop_timer</span>(s.ack);</span><br><span class="line">               <span class="built_in">from_network_layer</span>(&amp;buffer);</span><br><span class="line">               next_frame_to_send++;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   &gt;&#125;</span><br></pre></td></tr></table></figure>
<p>Receiver:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   &gt;<span class="function"><span class="type">void</span> <span class="title">receiver</span><span class="params">()</span></span>&#123;</span><br><span class="line">seq_nr frame_expected;</span><br><span class="line">   frame r, s;</span><br><span class="line">   event_type event;</span><br><span class="line">   </span><br><span class="line"> 	frame_expected = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">       <span class="built_in">wait_for_event</span>(&amp;event);</span><br><span class="line">       <span class="keyword">if</span> (event == frame_arrival)&#123;</span><br><span class="line">           <span class="built_in">from_physical_layer</span>(&amp;r);</span><br><span class="line">           <span class="keyword">if</span> (r.seq == frame_expected)&#123;</span><br><span class="line">               <span class="built_in">to_network_layer</span>(&amp;r.info);</span><br><span class="line">               frame_expected++;</span><br><span class="line">           &#125;</span><br><span class="line">           s.ack = frame_expected - <span class="number">1</span>;</span><br><span class="line">           <span class="built_in">to_physical_layer</span>(&amp;s);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   &gt;&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>Protocols in which the sender waits for a <strong>positive acknowledgement</strong> before advancing to the next data item are often called <strong>PAR</strong> (Positive Acknowledgement Retransmission) or <strong>ARQ</strong> (Automatic Repeater reQuest)</p>
</blockquote>
</li>
<li>
<p><strong>Sliding Window Protocols</strong>: One-Bit Sliding Window Protocol, Go-Back-N, Selective Repeat</p>
<blockquote>
<ul>
<li>
<p><strong>Problem</strong>(From Simplex to Duplex): We want to allow symmetric frame transmission between two communicating parties, rather than transmission in one direction. Don’t waste channels, <strong>so use the same channel for duplex communication</strong>.</p>
</li>
<li>
<p><strong>Principle</strong>: Use the same link for data in both directions, and interleave data and control frames on the same link.</p>
</li>
<li>
<p><strong>piggybacking</strong>: The technique of temporarily delaying outgoing acknowledgements so that they can be hooked onto the next outgoing data frame. （ack 和需要的发送的数据一起发送）</p>
</li>
</ul>
<hr>
<p>Q: How to improve the channel utilization ?</p>
<p>A: Rather than just sending a single frame at a time, permit the sender to transmit a set of frames.</p>
<p>Q: How to keep a fast sender from swamping a slower receiver with data?</p>
<p>A: Flow control–taking use of sliding window to limit frame send.</p>
<hr>
<p><strong>Sending Window</strong>: The sequence number within the sending windows represent frames that have been sent or can be sent but as yet not acknowledged. 允许发送帧的序号（在没有收到对方确认信息时，发送端最多允许发送多少帧）</p>
<p><strong>Receiving Window</strong>: The receiving window corresponds to the frames it may accept. Any frame falling outside the window is discarded without comment. 接收窗口：期待接收的帧序号（只有发送序号落在接收窗口内才允许接收）</p>
</blockquote>
</li>
<li>
<p>One-bit Sliding Window Protocol:</p>
<blockquote>
<p>Sending Window、Receiving Window 大小均为 1，即当且仅当收到了 ack，才可能发送下一个 frame。</p>
<p>因为 Duplex 双工，下面函数既是 Sender 也是 Receiver:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="type">void</span> <span class="title">send_receive</span><span class="params">()</span></span>&#123;</span><br><span class="line"> seq_nr next_frame_to_send, frame_expected;</span><br><span class="line"> frame r, s;</span><br><span class="line"> packet buffer;</span><br><span class="line"> event_type event;</span><br><span class="line"> </span><br><span class="line"> next_frame_to_send = <span class="number">0</span>;</span><br><span class="line"> frame_expected = <span class="number">0</span>;</span><br><span class="line"> <span class="built_in">from_network_layer</span>(&amp;buffer);</span><br><span class="line"> s.info = buffer;</span><br><span class="line"> s.seq = next_frame_to_send;</span><br><span class="line"> s.ack = frame_expected - <span class="number">1</span>; <span class="comment">// s里既有ack也有数据</span></span><br><span class="line"> <span class="built_in">to_physical_layer</span>(&amp;s);</span><br><span class="line"> <span class="built_in">start_timer</span>(s.seq);</span><br><span class="line"> <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">     <span class="built_in">wait_for_event</span>(&amp;event);</span><br><span class="line">     <span class="keyword">if</span> (event == frame_arrival)&#123;</span><br><span class="line"><span class="built_in">from_physical_layer</span>(&amp;r);</span><br><span class="line">         <span class="keyword">if</span> (r.seq == frame_expected)&#123;</span><br><span class="line">	<span class="built_in">to_network_layer</span>(&amp;r.info);</span><br><span class="line">             frame_expected++;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">if</span> (r.ack == next_frame_to_send)&#123;</span><br><span class="line">             <span class="built_in">stop_timer</span>(r.ack);</span><br><span class="line">             <span class="built_in">from_network_layer</span>(&amp;buffer);</span><br><span class="line">             next_frame_to_send++;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     s.info = buffer;</span><br><span class="line">     s.seq = next_frame_to_send;</span><br><span class="line">     s.ack = frame_expected - <span class="number">1</span>;</span><br><span class="line">     <span class="built_in">to_physical_layer</span>(&amp;s);</span><br><span class="line">     <span class="built_in">start_timer</span>(s.seq);</span><br><span class="line"> &#125;</span><br><span class="line"> &gt;&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li>
<p>Go-Back-N</p>
<blockquote>
<p>假设信道为 50kbps，往返的 propagation delay 为 500ms，那么用 One-bit sliding windows 发送 1000bit 的帧的效率为 “transmission delay/(transmission delay+propagation delay)=<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>1000</mn><mi mathvariant="normal">/</mi><mn>50</mn><mi>K</mi><mo>=</mo><mn>20</mn><mi>m</mi><mi>s</mi></mrow><mrow><mn>500</mn><mi>m</mi><mi>s</mi><mo>+</mo><mn>1000</mn><mi mathvariant="normal">/</mi><mn>50</mn><mi>K</mi><mo>=</mo><mn>20</mn><mi>m</mi><mi>s</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1000/50K=20ms}{500ms+1000/50K=20ms}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">5</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">s</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">/</span><span class="mord mtight">5</span><span class="mord mtight">0</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mrel mtight">=</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">s</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">/</span><span class="mord mtight">5</span><span class="mord mtight">0</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mrel mtight">=</span><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>” 很小，说明发送过程中，很长时间都在等待由于 propagation delay 引起的没收到 ack，导致不能传输。</p>
<p>解决方法就是增大 window 大小。</p>
<p>BD = 时延带宽积 / 帧长度，意味着在链路中能存储的帧的个数。我们设置窗口大小为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>2</mn><mi>B</mi><mi>D</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w=2BD+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>.</p>
<ul>
<li>Twice the bandwidth-delay is the number of frames that can be outstanding if the sender continuously sends frames when the round-trip time to receive an acknowledgement is considered.</li>
<li>The “+1” is because an acknowledgement frame will not be sent until after a complete frame is received.</li>
</ul>
<p><img data-src="30.png" alt="30"></p>
<p>假设 Sequence Number 最大为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>，发送方窗口大小为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">w_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，接收方窗口大小为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">w_R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，那么 Stop-and-wait protocol 就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>T</mi></msub><mo>=</mo><msub><mi>w</mi><mi>R</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w_T=w_R=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，而 Go-Back-N 就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>T</mi></msub><mo>≤</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>w</mi><mi>R</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w_T\leq N-1,w_R=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>.</p>
</blockquote>
</li>
<li>
<p>Selective Repeat</p>
<blockquote>
<p>The selective repeat protocol, is to allow the receiver to accept and buffer the frames following a damaged or lost one.</p>
<p>Both sender and receiver maintain a window of acceptable sequence number.</p>
<p>Sender only retransmit the wrong frame. Receiver buffers the right but disordered frames, and send Nak.</p>
<p><img data-src="31.png" alt="31"></p>
<p><img data-src="32.png" alt="32"></p>
<p>对此，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>T</mi></msub><mo>+</mo><msub><mi>w</mi><mi>R</mi></msub><mo>≤</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">w_T+w_R\leq N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 即可。</p>
</blockquote>
</li>
<li>
<p>Example Data Link Protocols</p>
<blockquote>
<p><strong>HDLC</strong>(Hight Level Data Link Control)</p>
<ul>
<li>
<p>Bit-oriented(Flag bits with bit stuffing)</p>
</li>
<li>
<p>HDLC provides reliable transmission with a sliding window, acknowledgements, and timeouts</p>
</li>
<li>
<p>HDLC Data Transfer Modes:</p>
</li>
<li>
<p>Normal Response Mode(NRM): Used with an unbalanced configuration, Primary initiates transfer</p>
</li>
<li>
<p>Asynchronous Balanced Mode(ABM): Used with a balanced configuration. Either station initiates transmission. Has no polling overhead. Most widely used.</p>
</li>
<li>
<p>Asynchronous Response Mode (ARM): Used with unbalanced configuration. Secondary may transmit without permission from primary. Rarely used.</p>
</li>
<li>
<p>Three types of frames:</p>
</li>
<li>
<p>Information frames: Carry the data to be transmitted for the user, Flow and error control data, using the ARQ mechanism, are piggybacked on an information frame.</p>
</li>
<li>
<p>Supervisory frames: Provide the ARQ mechanism when piggybacking is not used.</p>
</li>
<li>
<p>Unnumbered frames: Provide supplemental link control functions.</p>
</li>
<li>
<p>Fields:</p>
</li>
<li>
<p>Flag Field, 01111110</p>
</li>
<li>
<p>Address Field: Identifies secondary station that transmitted or will receive frame, Usually 8 bits long,  Address 11111111 allows a primary to broadcast a frame for reception by all secondaries</p>
</li>
<li>
<p>Control Field</p>
<p><img data-src="33.png" alt="33"></p>
<p>a)Use of poll/final (P/F) bit depends on context.</p>
<p>b)In command frames P bit is set to 1 to solicit (poll) a response from the peer HDLC entity.</p>
<p>c)In response frames F bit is set to 1 to indicate the response frame transmitted as a result of a soliciting command.</p>
<p>d)The basic control field for S- and I-frames uses 3 bit sequence numbers.</p>
</li>
<li>
<p>Information Field: Present only in I-frames and some U-frames. Must contain an integral number of octets. Variable length.</p>
</li>
<li>
<p>Frame Check Sequence Field (FCS): Error detecting code calculated from the remaining bits of the frame, exclusive of flags. The normal code is the 16 bit CRC-CCITT. Optional 32-bit FCS, using CRC-32, may be employed if the frame length or the line reliability dictates this choice.</p>
</li>
<li>
<p>I-Frame, used to transmit frame:</p>
</li>
<li>
<p>The protocol uses a sliding window, with a 3-bit sequence number.</p>
</li>
<li>
<p>The <em>Seq</em> field is the frame sequence number. The <em>Next</em> field is a piggybacked acknowledgement.</p>
</li>
<li>
<p>P/F（Poll/Final）</p>
<p>P: the computer is inviting the terminal to send data</p>
<p>F: the final frame.</p>
</li>
<li>
<p>S-Frame, used to control data stream</p>
</li>
<li>
<p>Type 0 is an acknowledgement 00, RR (Receive Ready), 接收准备就绪 ，确认帧。 Next：期望接收的下一帧的顺序号</p>
</li>
<li>
<p>Type 1 is a negative acknowledgement 01，拒绝（reject）Next ：指明了第一个未被正确接收的帧序号。要求重传的帧序号，从 Next 以后的帧都要重传。</p>
</li>
<li>
<p>Type 2 is RECEIVE NOT READY 10， REJECTRNR (Receive Not Ready) 接收未准备就绪。</p>
</li>
<li>
<p>Type 3 is the SELECTIVE REJECT. 11，Selective reject 选择性拒绝。Next： 指定帧重传，重传 Next 帧。</p>
</li>
<li>
<p>Unnumbered frame, used to control link</p>
</li>
<li>
<p>由 Type 和 Modifier 可定义 32 种帧，其中 15 种已经定义，主要用来呼叫封闭并报告链路控制的状态。</p>
</li>
</ul>
<p><strong>PPP</strong>(Point-to-Point Protocol)</p>
<ul>
<li>
<p>Byte-oriented</p>
</li>
<li>
<p>An “unnumbered mode” is nearly always used in the Internet to provide connectionless unacknowledged service.</p>
</li>
<li>
<p>Two situations:</p>
</li>
<li>
<p>Packet over SONET(This situation is when packets are sent over SONET optical fiber links in wide-area networks. These links are widely used , for example, to connect routers in the different locations of an ISP’s network. )</p>
</li>
<li>
<p>ADSL (This situation is for ADSL links running on the local loop of the telephone network at the edge of the Internet. These links connect millions of individuals and businesses to the Internet.)</p>
</li>
<li>
<p>Features:</p>
</li>
<li>
<p>A framing method that unambiguously delineates the end of one frame and the start of the next.</p>
</li>
<li>
<p>Link Control Protocol: A link control protocol for bringing lines up, testing them, negotiating options, and bringing them down again gracefully when they are no longer needed.</p>
</li>
<li>
<p>Network Control Protocol: A way to negotiate network layer options In a way that is independent of the network layer protocol to be used.</p>
</li>
<li>
<p>Frame Format:</p>
</li>
</ul>
<p><img data-src="34.png" alt="34"></p>
<p>Flag: 0x7E, ESC: 0X7D</p>
<p>The following byte is the XORed with 0x20. That is:</p>
<p>ESC FLAG =&gt; ESC (ESC xor 0x20) ESC (FLAG xor 0x20)</p>
<p>Protocol 字段为 0x0021，则 Payload 字段为 IP 数据报；Protocol 字段为 0xC021，则 Payload 字段是 PPP 链路控制数据；Protocol 字段为 0x8021，则 Payload 字段是网络控制数据。</p>
<ul>
<li>
<p>PPP 不需要纠错和 framing，因为它被封装在 AAL5 帧中，而 AAL5 自带纠错，AAL5 又会被 framing 成若干个 ATM cells。AAL（ATM Adaptation Layer），ATM（Asynchronous Transmission Mode）</p>
</li>
<li>
<p>AAL5 帧格式，通过 padding 需要让帧长度是 48bytes 的倍数：</p>
</li>
</ul>
<p><img data-src="35.png" alt="35"></p>
<ul>
<li>
<p>PPP 数据会在 AAL5 Payload 中，然后 AAL5 会被分成若干个 payload 为 48bytes，header 为 5bytes，总长为 53bytes 的 ATM cells 中。</p>
</li>
<li>
<p>PPP 既可以用低层的 SONET（Synchronous Optical Network）传输，也可以用低层的 ALL5-&gt;ATM-&gt;ADSL 传输。其中 ATM 中的 Asynchronous 意思为：</p>
</li>
</ul>
<p>The ‘‘Asynchronous’’ in its name means that the cells do not always need to be sent in the way that bits are continuously sent over synchronous lines, as in SONET. Cells only need to be sent when there is information to carry.</p>
<ul>
<li>ATM is a connection-oriented technology. Each cell carries a virtual circuit identifier in its header and devices use this identifier to forward cells along the paths of established connections.</li>
</ul>
</blockquote>
</li>
</ol>
<h2 id="第四章-medium-access-control-sublayer"><a class="markdownIt-Anchor" href="#第四章-medium-access-control-sublayer">#</a> 第四章 Medium Access Control Sublayer</h2>
<ol>
<li>
<p>MAC sublayer 的引出：</p>
<blockquote>
<ul>
<li>
<p>those using <strong>point-to-point</strong> <strong>channels</strong></p>
</li>
<li>
<p>those using <strong>broadcast channels (multiaccess channels or random access channels)</strong></p>
</li>
</ul>
<p>In any broadcast network, the key issue is how to determine who gets to use the channel when there is competition for it.</p>
<p>The protocols used to determine who goes next on a multiaccess channel belong to a sublayer of the data link layer called <strong>MAC</strong> <strong>(medium access control)</strong> sublayer.</p>
</blockquote>
</li>
<li>
<p>数据链路层可分为：</p>
<blockquote>
<p>Logical Link Control Sublayer (LLC):  the typical functions in data link Layer 执行通常的数据链路功能。</p>
<p>Medium Access Control Sublayer (MAC): allocation of multiaccess channel 处理有关媒体的访问控制；</p>
</blockquote>
</li>
<li>
<p>The Channel Allocation Problem</p>
<blockquote>
<p>How to allocate a single broadcast channel among competing users.</p>
<ul>
<li>
<p>Static Channel Allocation: mutiplexing</p>
</li>
<li>
<p>FDM</p>
</li>
<li>
<p>TDM</p>
</li>
<li>
<p>WDMA (Wavelength Division Multiple Access，波分多址)</p>
</li>
<li>
<p>CDMA (Code Division Multiple Access, 码分多址)</p>
</li>
<li>
<p>Dynamic Channel Allocation：</p>
</li>
<li>
<p>Random-access (contention) protocols: No station is superior to another station and none is assigned the control over another.</p>
<p>e.g. ALOHA, CSMA/CD, CSMA/CA</p>
</li>
<li>
<p>Controlled-access protocols: The stations consult one another to find which station has the right to send. A station cannot send unless it has been authorized by other stations.</p>
<p>Reservation, Polling, Token passing</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>ALOHA</p>
<blockquote>
<ul>
<li>Pure ALOHA: It allows all users to transmit whenever they want, and then check the channel for collisions.</li>
</ul>
<p>(How to find out the case? After each station has sent its frame to the central computer, this computer rebroadcasts the frame to all of the stations. A sending station can thus listen for the broadcast from the hub to see if its frame has gotten through.)</p>
<p>lf a collision occurs, they wait a random period of time and retransmit.</p>
<ul>
<li>Slotted ALOHA: Divide time into discrete intervals called slots, each interval corresponding to one frame.  The system requires to wait for the beginning of the next slot to transmit the frame. The vulnerable period reduces a half.</li>
</ul>
</blockquote>
</li>
<li>
<p>CSMA (Carrier Sense Multiple Access Protocols)</p>
<blockquote>
<p>1-persistent CSMA</p>
<ul>
<li>When a station has data to send, it first listens to the channel.</li>
<li>If the channel is idle, the station transmit its data immediately.</li>
<li>If the channel is busy, the station just waits until it becomes idle, and then transmits the frame.</li>
<li>If a collision occurs, the station waits a random amount of time and starts all over again.</li>
</ul>
<p>non-persistent CSMA</p>
<ul>
<li>A station senses the channel when it wants to send a frame.</li>
<li>If the channel is idle, the station transmit it immediately.</li>
<li>If the channel is busy, the station does not continually sense it and waits a random period of time and starts listening again.</li>
<li>Better Channel utilization but longer delays than 1-persistent CSMA.</li>
</ul>
<p>p-persistent CSMA</p>
<ul>
<li>When a station becomes ready to send, it senses the channel.</li>
<li>If the channel is idle, it transmits with a probability p, and defers with a probability 1-p until the next slot. If the channel is also idle, it either transmits or defers again. This process is repeated until either the frame has been transmitted or another station has begun transmitting (in the latter case, the unlucky station waits a random time and starts again).</li>
<li>If the station initially senses that the channel is busy, it waits until the next slot and applies the above algorithm.</li>
</ul>
<p>CSMA/CD (Collision Detection) CSMA: 先听再发，CD：边发边听。CSMA/CD is the basis of the classic Ethernet.</p>
<ul>
<li>When a station becomes ready to send, it senses the channel.</li>
<li>If the channel is idle, the station transmit it immediately.</li>
<li>When the station is transmitting, it is still sensing the collision.</li>
<li>If a collision is detected, the station just stopped, wait a random time, and go back to listening.</li>
</ul>
<p>CSMA/CD with Binary Exponential Backoff</p>
<ul>
<li>
<p>Classic Ethernet uses the 1-persistent CSMA/CD algorithm.</p>
</li>
<li>
<p>If there is a collision, they abort the transmission with a short jam signal and retransmit after a random interval.</p>
</li>
<li>
<p>After a collision, time is divided into discrete slots whose length is (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>τ</mi></mrow><annotation encoding="application/x-tex">2\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span>), equal to the worst-case round-trip propagation time on the ether.</p>
</li>
<li>
<p>When first detect collision, randomly wait 0 or 1 slots, when secondly detect collision, randomly wait 0 or 1 or 2 or 3 slots, …, when detect collision for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> times, randomly wait <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0,...,2^k-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> slots.</p>
</li>
<li>
<p>After 16 collisions have been detected, reports failure.</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>IEEE 802 standards</p>
<blockquote>
<ul>
<li>IEEE802.3 Ethernet</li>
</ul>
<p>(Since Ethernet and IEEE 802.3 are identical except for a minor difference, we use the terms “Ethernet” and “IEEE 802.3” interchangeably.)</p>
<p>(DEC, Intel and Xeror drew up a standard in 1978 for a 10Mbps Ethernet, called the DIX standard. With a minor change, the DIX standard became the IEEE 802.3 standard in 1983.)</p>
<ul>
<li>
<p>IEEE802.11 wireless LAN</p>
</li>
<li>
<p>IEEE802.15 Bluetooth wireless PAN</p>
</li>
<li>
<p>IEEE802.16 wireless MAN</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>Two kinds of Ethernet</p>
<blockquote>
<ul>
<li>
<p>Classic Ethernet, which solves the multiple access problem using CSMA/CD, is the original form and ran at rates from 3 to 10Mbps.</p>
</li>
<li>
<p>Switched Ethernet, in which devices called switches are used to connect different computers, is what Ethernet has become and runs at 100, 1000, and 10000Mbps, in forms called fast Ethernet, gigabit Ethernet, and 10 gigabit Ethernet.</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>Classic Ethernet Physical Layer</p>
<blockquote>
<p><img data-src="36.png" alt="36"></p>
<p>10: it operates at 10Mbps</p>
<p>5: The maximum cable length is 500 meters.</p>
<p>2: The maximum cable length is 200 meters.</p>
<p>Base: Base: using baseband signaling</p>
</blockquote>
</li>
<li>
<p><strong>Repeaters</strong></p>
<blockquote>
<p>To allow larger network, multiple cables are connected by repeaters.</p>
<p>A repeater is a physical layer device that receives, amplifies (regenerates) and retransmits signals in both directions.</p>
<p>An Ethernet could contain multiple cable segments and multiple repeaters, but no two transceivers could be more than 2.5km apart and no path between any two transceivers could travers more than four repeaters.</p>
</blockquote>
</li>
<li>
<p>Ethernet Frame Format</p>
<blockquote>
<p>There are two different MAC Protocols:</p>
<ul>
<li>DIX: was introduced first, was most widely used</li>
<li>IEEE802.3: was introduced later, was not widely used, they are close enough that it makes little difference</li>
</ul>
<p><img data-src="37.png" alt="37"></p>
<p>Fields:</p>
<ul>
<li>Preamble: Seven times 10101010 is used to synchronize the receiver’s clock with that of the sender.</li>
<li>SOF: Just a delimiter 10101011 to tell that the real information is now coming.</li>
<li>Address: Generally 48-bit fields. Leftmost bit indicates ordinary（0） or group（1） addresses.</li>
<li>Data: Ranges from 0-1500bytes. Frames should always be at least 64 bytes. (The limit was chosen somewhat arbitrarily at the time the Ethernet standard was cast in stone, mostly based on the fact that a transceiver needs enough RAM to hold an entire frame and RAM was expensive in 1978.)</li>
<li>Type (DIX) or Length (802.3): any number there less than or equal to 0x600(1536) can be interpreted as <em>Length,</em> and any number greater than 0x600 can be interpreted as <em>Type.</em></li>
<li>Checksum: Calculated over the data field. CRC-based.</li>
</ul>
<p>Ethernet requires that valid frames must be <strong>at least</strong> 64 bytes long, from destination address to checksum, including both.</p>
<p>If the data portion of frame is less than 46 bytes, the Pad Field is used to fill out the frame to the minimum size.</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi>f</mi><mi>r</mi><mi>a</mi><mi>m</mi><mi>e</mi><mtext>  </mtext><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi></mrow><msub><mi>v</mi><mi>t</mi></msub></mfrac><mo>≥</mo><mfrac><mrow><mn>2</mn><mi>τ</mi></mrow><msub><mi>v</mi><mi>p</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\frac{frame\;length}{v_t}\geq\frac{2\tau}{v_p}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714399999999998em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.293548em;vertical-align:-0.972108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.972108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">v_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the rate for transmission and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">v_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> is the rate for propagation. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> is the time needed for the frame to travel around the channel.</p>
<p>The reason for minimal frame length is for collision detection and frame validation (length &lt;= 46 bytes is invalid frame).</p>
</blockquote>
</li>
<li>
<p>Ethernet performance</p>
<blockquote>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>a</mi><mo>=</mo><mfrac><mrow><mi>τ</mi><msub><mi>v</mi><mi>t</mi></msub></mrow><mi>L</mi></mfrac></mrow><annotation encoding="application/x-tex">a=\frac{\tau v_t}{L}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> is round-trip time, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span></span></span></span> is the frame length. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span> means the rate the transmission time over the propagation time. If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span> is low, channel throughtput will be high.</p>
<p><strong>Problem</strong>: As more stations are added, each station gets a decreasing share of the fixed capacity. Eventually, the network will saturate.</p>
<p><strong>Solution:</strong> To go to a higher speed, or use switched Ethernet.</p>
</blockquote>
</li>
<li>
<p>Switched Ethernet</p>
<blockquote>
<p><img data-src="38.png" alt="38"></p>
<p>With the advantages of being able to use existing wiring and ease of maintenance, twisted-pair hubs quickly became the dominant form of Ethernet. However, hubs do not increase capacity because they are <strong>logically equivalent to the single long cable</strong> of classic Ethernet.</p>
<p>A switch contains a high-speed backplane that <strong>connects all of the ports.</strong> Switches only output frames to the ports for which those frames are destined.</p>
<p>Q: What happens if more than one of the stations or ports wants to send a frame at the same time?</p>
<p>A: Again, switches differ from hubs. In a hub, all stations are in the same collision domain. They must use the CSMA/CD algorithm to schedule their transmissions. In a switch, each port is its own independent collision domain. In the common case that the cable is full duplex, both the station and the port can send a frame on the cable at the same time, without worrying about other ports and stations. Collisions are now impossible and CSMA/CD is not needed. However, if the cable is half duplex, the station and the port must contend for transmission with CSMA/CD in the usual way</p>
<p>(Full duplex 全双工：信号可以同时双向传输，相当于两个方向的单工</p>
<p>Half duplex 半双工：信号可以双向传输，但不能同时双向传输。所以会导致竞争)</p>
<p>Q: What happens if most LAN interfaces work on the promiscuous mode？（混杂模式，即设备接受所有流过的帧，而不管帧的终点地址是不是它）</p>
<p>A: With a hub, every computer that is attached can see the traffic sent between all of the other computers. With a switch, traffic is forwarded <u>only to</u> the ports where it is destined. The change in the ports on which frames are output has security benefits.</p>
</blockquote>
</li>
<li>
<p>Fast Ethernet</p>
<blockquote>
<table>
<thead>
<tr>
<th>Name</th>
<th>Cable</th>
<th>Max. segment</th>
<th>Advantages</th>
</tr>
</thead>
<tbody>
<tr>
<td>100Base-T4</td>
<td>Twisted pair</td>
<td>100m</td>
<td>Uses category 3 UTP</td>
</tr>
<tr>
<td>100Base-TX</td>
<td>Twisted pair</td>
<td>100m</td>
<td>Full duplex at 100 Mbps</td>
</tr>
<tr>
<td>100Base-FX</td>
<td>Fiber optics</td>
<td>2000m</td>
<td>Full duplex at 100 Mbps</td>
</tr>
</tbody>
</table>
</blockquote>
</li>
<li>
<p>10 Gigabit Ethernet</p>
<blockquote>
<table>
<thead>
<tr>
<th>Name</th>
<th>Cable</th>
<th>Max. semgnet</th>
<th>Advantages</th>
</tr>
</thead>
<tbody>
<tr>
<td>10GBase-SR</td>
<td>Fiber optics</td>
<td>Up to 300m</td>
<td>Multimode fiber</td>
</tr>
<tr>
<td>10GBase-LR</td>
<td>Fiber optics</td>
<td>10km</td>
<td>SIngle-mode fiber</td>
</tr>
<tr>
<td>10GBase-ER</td>
<td>Fiber optics</td>
<td>40km</td>
<td>Single-mode fiber</td>
</tr>
<tr>
<td>10GBase-CX4</td>
<td>4 Pairs of twinax</td>
<td>15m</td>
<td>Twinaxial copper</td>
</tr>
<tr>
<td>10GBase-T</td>
<td>4 Pairs of UTP</td>
<td>100m</td>
<td>Category 6a UTP</td>
</tr>
</tbody>
</table>
</blockquote>
</li>
<li>
<p>Wireless LANs</p>
<blockquote>
<p>802.11 architecture: infrastructure mode</p>
<p><img data-src="39.png" alt="39"></p>
<p>802.11 architecture: ad hoc mode:<br>
<img data-src="40.png" alt="40"></p>
<p>802.11 protocol stack:</p>
<p><img data-src="41.png" alt="41"></p>
<p>The 802.11 MAC sublayer protocol is quite different from that of Ethernet, due to two factors that are fundamental to wireless communications.</p>
<ul>
<li>Most radios are half duplex. They cannot transmit and listen for noise bursts at the same time on a single frequency. The received signal can easily be a million times weaker than the transmitted signal, so it can not be heard at the same time. (solution: CSMA/CA)</li>
<li>The transmission ranges of different stations may be different. In wireless LANs, not all stations are within range of each other, which leads to a variety of complications: the hidden/exposed station problem. (solution: channel sensing including both physical sensing and virtual sensing.)</li>
</ul>
<p>CSMA/CA: Acknowledgements are used to infer collisions because collisions cannot be detected, and after acknowledgement, there will be a backoff, then the channel will become idle:</p>
<p><img data-src="42.png" alt="42"></p>
<p>The mode of operation, i.e., CSMA/CA, is called <strong>DCF</strong> (Distributed Coordination Function) because each station acts independently, without any kind of central control.</p>
<p>The standard also includes an optional mode of operation called PCF (Point Coordination Function) in which the access point controls all activity in its cell, just like a cellular base station. In practice, PCF is not used.</p>
</blockquote>
</li>
<li>
<p>The hidden terminal problem &amp; exposed terminal problem:</p>
<blockquote>
<p><img data-src="43.png" alt="43"><img data-src="44.png" alt="44"></p>
</blockquote>
</li>
<li>
<p>MACA Protocol</p>
<blockquote>
<p>An early and influential protocol that tackles the hidden and exposed terminal problems for wireless LANs is <strong>MACA</strong> (Multiple Access with Collision Avoidance).</p>
<p>The basic idea behind it is for the sender to stimulate the receiver into outputting a short frame, so stations nearby can detect this transmission and avoid transmitting for the duration of the upcomming (large) data frame.</p>
<p><img data-src="45.png" alt="45"></p>
<p>RTS=Request to send, CTS=Clear to send</p>
<p>To reduce ambiguities about which station is sending, 802.11 defines channel sensing to consist of both physical sensing and virtual sensing.</p>
<ul>
<li>Physical sensing simply checks the medium to see if there is a valid signal.</li>
<li>With virtual sensing, each station keeps a logical record of when the channel is in use by tracking the NAV (Network Allocation Vector).</li>
<li>An optional RTS/CTS mechanism uses the NAV to prevent terminals from sending frames at the same time as hidden terminals.</li>
</ul>
</blockquote>
</li>
<li>
<p>802.11 Frame structure</p>
<blockquote>
<p><img data-src="46.png" alt="46"></p>
</blockquote>
</li>
<li>
<p>Services</p>
<blockquote>
<p><img data-src="47.png" alt="47"></p>
<p>The 802.11 standard states that each con formant wireless LAN must provide <strong>five distribution services and four station services</strong>.</p>
<ul>
<li>
<p>The distribution services relate to managing cell membership and interacting with stations outside the cell.</p>
</li>
<li>
<p>The five distribution services are provided by the base stations and deal with station mobility as they enter and leave cells, attaching themselves to and detaching themselves from base stations.</p>
</li>
<li>
<p>The four station services are relate to actions within a single cell. They are used after association has taken place.</p>
</li>
</ul>
<p>Distribution Services:</p>
<ul>
<li><strong>Association</strong> - connect to base station.</li>
<li><strong>Disassociation</strong> - disconnect from base station</li>
<li><strong>Re-association</strong> – change base station connection while moving</li>
<li><strong>Distribution</strong> – how frames are routed to the base station</li>
<li><strong>Integration</strong> – for frames passing through non-802.11 networks.</li>
</ul>
<p>Intracell Services:</p>
<ul>
<li><strong>Authentication</strong> – makes sure that the mobile station is allowed to connect and is who it says it is.</li>
<li><strong>Deauthentication</strong> – used when an previously authenticated station leaves the network</li>
<li><strong>Privacy</strong> – encryption for data</li>
<li><strong>Data Delivery</strong> – not guaranteed with error detection at higher levels</li>
</ul>
</blockquote>
</li>
<li>
<p>Bridges connecting LANs</p>
<blockquote>
<p>Bridges from 802.x to 802.y</p>
<p><img data-src="48.png" alt="48"></p>
<p>Local Internetworking:</p>
<p><img data-src="49.png" alt="49"></p>
<p>Remote Bridges can be used to interconnect distant LANs:<br>
<img data-src="50.png" alt="50"></p>
<hr>
<p>Uses of Bridges:</p>
<ul>
<li>LANs can be connected by devices called bridges, which operate in the <strong>data link layer</strong>.</li>
<li>Bridges examine the data link layer addresses to do routing, do not suppose to examine the payload field of the route.</li>
<li>Ideally bridges should be completely <strong>transparent</strong>. It is one <strong>plug-and-play</strong> device.</li>
<li>Two algorithms are used: a <strong>backward learning</strong> algorithm to stop traffic being sent where it is not needed; a <strong>spanning tree</strong> algorithm to break loops that may be formed when switches are cabled together willy-nilly.</li>
</ul>
<hr>
<p>When a frame arrives, a bridge must decide whether to discard or forward it, and if the latter, on which LAN to put the frame. This decision is made by looking up the destination address in a big (hash) table inside the bridge：</p>
<p><img data-src="51.png" alt="51"></p>
<ul>
<li>
<p>Bridges use a routing table (or hash table) to determine how to route the frames.</p>
</li>
<li>
<p>The method used to determine how to route the frames is called <strong>backward learning</strong>：</p>
</li>
</ul>
<p>This is done by listening to all of the frames on the connections and building the hash table. The hash table need to be kept up to date.</p>
<ul>
<li>
<p>Building hash table: Initial state, hash table is empty. When receiving a frame, Bridge will register its source MAC address and its incoming port into the hash table.</p>
</li>
<li>
<p>Bridge Routing Procedure:</p>
<ul>
<li>If  the port for the destination address is the same as the source port, discard the frame.</li>
<li>If the port for the destination address and the source port are different, forward the frame.</li>
<li>If the destination port is unknown, use flooding and send the frame on all ports except the source port.</li>
</ul>
</li>
<li>
<p>Update Hash table: To handle the dynamic topologies of the LANs, the arrival time of the frame should be noted in the entry. Whenever a frame whose source is already in the table arrives, its entry is updated with the current time.</p>
</li>
<li>
<p>Spanning Tree Bridges (Bridges serve as edges and LANs serves as nodes):</p>
</li>
<li>
<p>choose one bridge to be the root of the tree</p>
</li>
<li>
<p>a tree of shortest paths from the root to every bridge and LAN is constructed</p>
</li>
<li>
<p>if a bridge or LAN fails, a new one is computed</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>Repeaters, Hubs, Bridges, Switches, Routers and Gateways</p>
<blockquote>
<p>They operate in different layers, the layer matters because different devices use different pieces of information to decide how to switch</p>
<p><img data-src="52.png" alt="52"></p>
<p><strong>Repeaters</strong>: amplify signal. do not understand frames, packets, or headers, only understand volts.</p>
<p><strong>Hubs</strong>: not amplify incoming signals, not examine 802 addresses. The entire hub forms a single collision domain.</p>
<p><strong>Bridges:</strong> connect LANs, route on frame address, each line is its own collision domain.</p>
<p><strong>Switches:</strong> connect individual computers, route on frame address, never lose frames to collisions.</p>
<p><strong>Routers</strong>: introduced later.</p>
</blockquote>
</li>
<li>
<p>Virtual LANs</p>
<blockquote>
<p>To configure LANs logically rather than physically with hub and switch.</p>
<p>Reasons: security, load, broadcasting: broadcast storm.</p>
<p>Many LANs are organized according to a physical division of workstations, possibly having multiple LANs connected by bridges for sake of better management (and security)</p>
<p>The physical organization may not correspond at all with what would seem logically the best organization (e.g., based on membership of a department).</p>
<p><img data-src="53.png" alt="53"></p>
</blockquote>
</li>
<li>
<p>IEEE802.1Q Standard</p>
<blockquote>
<p>Bridged LAN that is only partly VLAN-aware. The shaded symbols are VLAN aware. The empty ones are not:</p>
<p><img data-src="54.png" alt="54"></p>
<p>The 802.3(legacy) and 802.1Q Ethernet frame formats:</p>
<p><img data-src="55.png" alt="55"></p>
</blockquote>
</li>
</ol>
<h2 id="第五章-the-network-layer"><a class="markdownIt-Anchor" href="#第五章-the-network-layer">#</a> 第五章 The Network Layer</h2>
<ol>
<li>
<p>Introduction</p>
<blockquote>
<p>The network layer is concerned with getting packets from the source all the way to the destination.</p>
<p>Getting to the destination may require making many hops at intermediate routers along the way.</p>
</blockquote>
</li>
<li>
<p>Network layer design issues</p>
<blockquote>
<ul>
<li>Store-and-forward packet switching</li>
<li>Services provided to transport layer</li>
<li>Implementation of connectionless service</li>
<li>Implementation of connection-oriented service</li>
<li>Comparison of virtual-circuit and datagram networks</li>
</ul>
</blockquote>
</li>
<li>
<p>Store-and-Forward Packet Switching</p>
<blockquote>
<p>At the network layer, the packet is delivered by intermediate routers hop by hop using store-and-forward packet switching:</p>
<ul>
<li>A host with a <strong>packet</strong> to send transmits it to the <strong>nearest router (the default router)</strong>.</li>
<li>The packet is <strong>stored</strong> in the router until it has <strong>fully arrived</strong> and the link has finished its processing by <strong>verifying</strong> the checksum.</li>
<li>Then it is <strong>forwarded to the next router along the path</strong> until it reaches the destination host, where it is delivered.</li>
</ul>
</blockquote>
</li>
<li>
<p>Services provided to the transport layer</p>
<blockquote>
<ul>
<li>The services should be <strong>independent</strong> of the router technology.</li>
<li>The transport layer should be <strong>shielded</strong> from the number, type, and topology of the routers present.</li>
<li>The network addresses made available to the transport layer should use <strong>a uniform numbering plan</strong>, even cross LANs and WANs.</li>
</ul>
</blockquote>
</li>
<li>
<p>Two-type of services:</p>
<blockquote>
<p>Connection-less services (Datagram)</p>
<ul>
<li>Based on 40 years of experience with the real computer network</li>
<li>The network is inherently unreliable.</li>
<li>The hosts should do error control and flow control.</li>
<li>Example: IP protocol;</li>
</ul>
<p>Connection-oriented services. (Virtual Circuit)</p>
<ul>
<li>
<p>Based on 100 years of experience with the worldwide telephone system.</p>
</li>
<li>
<p>The network should provide a reliable service.</p>
</li>
<li>
<p>Quality of service is the dominant factor.</p>
</li>
<li>
<p>Examples: X.25; Frame Relay; ATM; MPLS;</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>Implementation of Connectionless Service</p>
<blockquote>
<p>The packet are called <strong>datagram</strong> and the network is called a datagram network .</p>
<p><strong>Best effort delivery</strong>: If unreliable connectionless service is offered, packets are injected into the network individually and routed independently of each other. No advance setup is needed.</p>
<p>Each individual datagram is routed in the datagram subnet according to the <strong>routing tables</strong> stored in the router.</p>
<p>Each datagram <strong>have complete address information</strong>, and does not have to follow the same route as the ones before it.</p>
</blockquote>
</li>
<li>
<p>Implementation of Connection-Oriented Service</p>
<blockquote>
<p>A path from the source router all the way to the destination router must be established and <strong>stored in tables inside the routers</strong> before any data packets can be sent. The connection is called a VC (virtual circuit) and the network is called a virtual-circuit network.</p>
<p>A connection between the two machines is <strong>established</strong>, creating a virtual circuit where the route data will travel is predetermined.</p>
<p>All traffic flow over the connection.</p>
<p>When the connection is <strong>released</strong>, the virtual circuit is also terminated.</p>
<p>Each packet carries information not about the destination, but about which virtual circuit they belong to.</p>
</blockquote>
</li>
<li>
<p>Comparison of Virtual-Circuit and Datagram Subnets</p>
<p><img data-src="56.png" alt="56"></p>
</li>
<li>
<p>Routing Algorithm</p>
<blockquote>
<p>The routing algorithm is responsible for deciding which output line an incoming packet should be transmitted on.</p>
<ul>
<li><strong>Forwarding</strong>, which is what happens when a packet arrives.</li>
<li><strong>Routing</strong>, which is making the decision which routes to use.</li>
</ul>
<p>Algorithms:</p>
<ul>
<li>The Optimality Principle</li>
<li>Shortest Path Routing</li>
<li>Flooding</li>
<li>Distance Vector Routing</li>
<li>Link State Routing</li>
<li>Hierarchical Routing</li>
<li>Broadcast Routing</li>
<li>Multicast Routing</li>
<li>Routing for Mobile Hosts</li>
<li>Routing in Ad Hoc Networks</li>
</ul>
<hr>
<p>Two major classes of routing algorithms:</p>
<ul>
<li><strong>Nonadaptive or Static algorithms</strong> do not base their routing decisions on any measurements or estimates of the current topology and traffic. The choice of the route to use is computed in advance, off-line, and downloaded to the routers when the network is booted.</li>
<li><strong>Adaptive or Dynamic algorithms</strong> change their routing decisions to reflect changes in the topology, and usually changes in the traffic as well.</li>
</ul>
<hr>
<p>Shortest Path：把 packet 交给离目的地最近的出口。</p>
<p>Flooding：把 packet 交给所有出口。</p>
<p>Distance Vector Routing：每隔 30 秒，距离向量路由协议就要向相邻站点发送整个<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTglQjclQUYlRTclOTQlQjElRTklODAlODklRTYlOEIlQTklRTglQTElQTg/ZnJvbU1vZHVsZT1sZW1tYV9pbmxpbms=">路由选择表</span>，使相邻站点的路由选择表得到更新。这样，它就能从别的站点（直接相连的或其他方式连接的）收集一个网络的列表，以便进行<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTglQjclQUYlRTclOTQlQjElRTklODAlODklRTYlOEIlQTk/ZnJvbU1vZHVsZT1sZW1tYV9pbmxpbms=">路由选择</span>。距离向量路由协议使用跳数作为<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlQkElQTYlRTklODclOEYlRTUlODAlQkM/ZnJvbU1vZHVsZT1sZW1tYV9pbmxpbms=">度量值</span>，来计算到达目的地要经过的<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTglQjclQUYlRTclOTQlQjElRTUlOTklQTg/ZnJvbU1vZHVsZT1sZW1tYV9pbmxpbms=">路由器</span>数。</p>
</blockquote>
</li>
<li>
<p>Congestion Control</p>
<blockquote>
<p>Congestion Control: A global issue, involving the behavior of all the hosts, all the routers and other factors.</p>
<p>Flow Control: Relates to the point-to-point traffic between a given sender and receiver, to make sure that a faster sender cannot drown the receiver with fast sending rate.</p>
</blockquote>
</li>
<li>
<p>Quality of Service</p>
<blockquote>
<p>Application requirements</p>
<p><img data-src="57.png" alt="57"></p>
<p>Categories of QoS and Examples:</p>
<ul>
<li>Constant bit rate (Telephony)</li>
<li>Real-time variable bit rate (Compressed videoconferencing)</li>
<li>Non-real-time variable bit rate (Watching a movie on demand)</li>
<li>Available bit rate (File transfer)</li>
</ul>
</blockquote>
</li>
<li>
<p>Internetworking</p>
<blockquote>
<p>However Networks differ</p>
<p><img data-src="58.png" alt="58"></p>
<p>How Networks Can Be Connected:</p>
<ul>
<li>We can build devices that translate or convert packets from each kind of network into packets for each other network.</li>
<li>We can try to solve the problem by adding a layer of indirection and building a common layer on top of the different networks.</li>
</ul>
<p>Bridges are predominantly used to connect the same kind of network at the link layer.</p>
<p>Routers connect different networks at the network layer.</p>
<p><img data-src="60.png" alt="60"></p>
</blockquote>
</li>
<li>
<p>Router architecture</p>
<blockquote>
<p><img data-src="59.png" alt="59"></p>
</blockquote>
</li>
<li>
<p>Tunneling</p>
<blockquote>
<p>Handling the general case of making two different networks interwork is exceedingly difficult.</p>
<p>This case is where the source and destination hosts are on the same type of network, but there is a different network in between. e.g. IPv4-&gt;IPv6-&gt;IPv4.</p>
<p>The solution to this problem is a technique called <strong>tunneling</strong>.</p>
<hr>
<p>Tunneling is widely used to connect isolated hosts and networks using other networks.</p>
<p>The network that results is called an <strong>overlay</strong> since it has effectively been overlaid on the base network.</p>
<p>The limitations of tunnels is turned into an advantage with <strong>VPN</strong>s (Virtual Private Networks). A VPN is simply an overlay that is used to provide a measure of security.</p>
<p><img data-src="61.png" alt="61"></p>
</blockquote>
</li>
<li>
<p>Packet Fragmentation</p>
<blockquote>
<p>Hosts usually prefer to transmit large packets.</p>
<p>Q: How to do when a large packet wants to travel through a network whose maximum packet size is too small?</p>
<p>A: One solution is to make sure the problem does not occur in the first place. A source know how small packets must be to get through (Path Maximum Transmission Unit). The alternative solution is to allow routers to break up packets into <strong>fragments</strong>, sending each fragment as a separate network layer packet.</p>
<hr>
<p>Different networks may impose different maximum packet sizes. Thus, a packet may need to be spited into smaller ones when forwarding it through a network whose maximum packet size is small.</p>
<p>Q: Where to reassemble the fragments?</p>
<p>A: The intermediate routers (Transparent fragmentation): to make the fragmentation invisible to any other network. on the gateway, split and reconstruction the packet.</p>
<p>A: The destination host (Nontransparent fragmentation): fragmentation results in all of the fragmented packets traveling through multiple networks to get to the destination, leaving the destination to put them back together.</p>
</blockquote>
</li>
<li>
<p>Design Principles for Internet</p>
<blockquote>
<ol>
<li>
<p>Make sure it works.</p>
</li>
<li>
<p>Keep it simple.</p>
</li>
<li>
<p>Make clear choices.</p>
</li>
<li>
<p>Exploit modularity.</p>
</li>
<li>
<p>Expect heterogeneity.</p>
</li>
<li>
<p>Avoid static options and parameters.</p>
</li>
<li>
<p>Look for a good design; it need not be perfect.</p>
</li>
<li>
<p>Be strict when sending and tolerant when receiving.</p>
</li>
<li>
<p>Think about scalability.</p>
</li>
<li>
<p>Consider performance and cost.</p>
</li>
</ol>
</blockquote>
</li>
<li>
<p>IPv4 Header Format</p>
<blockquote>
<p>The IPv4 header (20 bytes):</p>
<p><img data-src="62.png" alt="62"></p>
<ul>
<li>
<p>Version (4 bits): indicate version of IP protocol (IPv4 or IPv6)</p>
</li>
<li>
<p>IHL (首部长度): 占 4 位，可表示的最大数值是 15 个单位 (一个单位为 4 字节) 因此 IP 的首部长度的最大值是 60 字节。</p>
</li>
<li>
<p>Type of Service (区分服务): 占 8 位，用来获得更好的服务前 6 位标记数据包的服务类型（可靠与加速的可能组合），后 2 位用来携带显示拥塞通知。只有在使用区分服务（DiffServ）时，这个字段才起作用。在一般的情况下都不使用这个字段</p>
</li>
<li>
<p>Total length (总长度): 占 16 位，指首部和数据之和的长度，单位为字节，因此数据报的最大长度为 65535 字节。总长度必须不超过最大传送单元 MTU。</p>
</li>
<li>
<p>Identification (标识): 占 16 位，计数器，每产生一个新的数据报，计数器加 1。属于同一个数据包的各个分片的标识都相同。</p>
</li>
<li>
<p>Flag (标志): 占 3 位，目前只有后两位有意义。标志字段的最低位是 <strong>MF</strong> (More Fragment)。MF = 1 表示后面 “还有分片” MF = 0 表示最后一个分片。标志字段中间的一位是 DF (Don’t Fragment) 。只有当 DF = 0 时才允许分片。</p>
</li>
<li>
<p>Fragment offset (片偏移): 占 12 位，指出较长的分组在分片后某片在原分组中的相对位置。片偏移以 8 个字节为偏移单位。</p>
</li>
</ul>
<p>片偏移例子：</p>
<p><img data-src="63.png" alt="63"></p>
<ul>
<li>
<p>TTL (生存时间): 占 8 位，记为 TTL (Time To Live) 数据报在网络中可通过的路由器数的最大值。</p>
</li>
<li>
<p>Protocol (协议): 占 8 位，指出此数据报携带的数据使用何种协议以便目的主机的 IP 层将数据部分上交给哪个处理过程。</p>
</li>
</ul>
<p><img data-src="64.png" alt="64"></p>
<ul>
<li>Header Checksum (首部检验和): 占 16 位，只检验数据报的首部不检验数据部分。这里不采用 CRC 检验码而采用简单的计算方法。</li>
</ul>
<p><img data-src="65.png" alt="65"></p>
<ul>
<li>
<p>Source Address &amp; Destination Address: 占 4 字节，为 IP 地址。</p>
</li>
<li>
<p>Options: IP 首部的可变部分就是一个选项字段，用来支持排错、测量以及安全等措施，内容很丰富。选项字段的长度可变，从 1 个字节到 40 个字节不等，取决于所选择的项目。增加首部的可变部分是为了增加 IP 数据报的功能，但这同时也使得 IP 数据报的首部长度成为可变的。这就增加了每一个路由器处理数据报的开销。实际上这些选项很少被使用。</p>
</li>
</ul>
<p>IP Options:<img data-src="66.png" alt="66"></p>
</blockquote>
</li>
<li>
<p>IP Address</p>
<blockquote>
<p>The addresses used in with the IPv4 protocol are 32-bit addresses.</p>
<p>The IP address is not actually the address of the machine, but the address of the network interface.</p>
<p>If a computer had two connections to two networks, it would also have two IP addresses.</p>
<hr>
<p><img data-src="67.png" alt="67"></p>
<p><img data-src="68.png" alt="68"></p>
<p>注：上图中错误，A 类主机号有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>24</mn></msup><mo>−</mo><mn>2</mn><mo>=</mo><mn>16777214</mn></mrow><annotation encoding="application/x-tex">2^{24}-2=16777214</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord">7</span><span class="mord">7</span><span class="mord">7</span><span class="mord">2</span><span class="mord">1</span><span class="mord">4</span></span></span></span>，而不是 32。</p>
<p>IP 地址管理机构在分配 IP 地址时只分配网络号，而剩下的主机号则由得到该网络号的单位自行分配。这样就方便了 IP 地址的管理。路由器仅根据目的主机所连接的网络号来转发分组（而不考虑目的主机号），这样就可以使路由表中的项目数大幅度减少，从而减小了路由表所占的存储空间。</p>
<hr>
<ul>
<li>
<p><strong>实际上 IP 地址是标志一个主机（或路由器）和一条链路的接口！</strong></p>
</li>
<li>
<p><strong>当一个主机同时连接到两个网络上时，该主机就必须同时具有两个相应的</strong> <strong>IP</strong> <strong>地址</strong>，其网络号 net-id 必须是不同的。这种主机称为<strong>多归属主机</strong> (multihomed host)。</p>
</li>
<li>
<p>由于一个路由器至少应当连接到两个网络（这样它才能将 IP 数据报从一个网络转发到另一个网络），因此<strong>一个路由器至少应当有两个不同的 IP 地址</strong>。</p>
</li>
<li>
<p>用<strong>转发器或网桥</strong>连接起来的若干个局域网仍为<strong>一个网络</strong>，因此这些局域网都具有<strong>同样的网络号</strong> <strong>net-id</strong>。</p>
</li>
<li>
<p>所有<strong>分配到网络号</strong> <strong>net-id</strong> <strong>的网络</strong>，范围很小的局域网，还是可能覆盖很大地理范围的广域网，都是<strong>平等</strong>的。</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>Subnets</p>
<blockquote>
<p>划分子网只是把 IP 地址的主机号 host-id 这部分进行再划分，而不改变 IP 地址原来的网络号 net-id。 net-id 和 subnet-id 统称网络号，或网络地址。</p>
<p>从一个 IP 数据报的首部并无法判断源主机或目的主机所连接的网络是否进行了子网划分。使用<strong>子网掩码</strong> (subnet mask) 可以找出 IP 地址中的子网部分。</p>
<p><img data-src="69.png" alt="69"></p>
<p>A 类地址默认子网掩码为 255.0.0.0, B 类为 255.255.0.0, C 类为 255.255.255.0</p>
<ul>
<li>
<p>路由器在和相邻路由器交换路由信息时，必须把自己所在网络（或子网）的子网掩码告诉相邻路由器。</p>
</li>
<li>
<p>路由器的路由表中的每一个项目，除了要给出目的网络地址外，还必须同时给出该网络的子网掩码。</p>
</li>
</ul>
<p><img data-src="70.png" alt="70"></p>
<ul>
<li>
<p>若一个路由器连接在两个子网上就拥有两个网络地址和两个子网掩码。</p>
</li>
<li>
<p>不同的子网掩码可能得出相同的网络地址。但不同的掩码的效果是不同的。</p>
</li>
</ul>
<hr>
<p>需要指出：</p>
<ul>
<li>IP 数据报的首部中没有地方可以用来指明 “下一跳路由器的 IP 地址”。</li>
<li>当路由器收到待转发的数据报，不是将下一跳路由器的 IP 地址填入 IP 数据报，而是送交下层的网络接口软件。</li>
<li>网络接口软件使用 ARP 协议（广播）负责将下一跳路由器的 IP 地址转换成硬件地址，并将此硬件地址放在链路层的 MAC 帧的首部，然后根据这个硬件地址找到下一跳路由器。</li>
</ul>
</blockquote>
</li>
<li>
<p>CIDR（classless InterDomain Routing，无分类编址）</p>
<blockquote>
<p>CIDR 消除了传统的 A 类、B 类和 C 类地址以及划分子网的概念，因而可以更加有效地分配 IPv4 的地址空间。CIDR 使用各种长度的 “网络前缀”(network-prefix) 来代替分类地址中的网络号和子网号。</p>
<p>例：128.14.32.0/20 表示的地址块共有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>12</mn></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^{12}-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span> 个地址（因为斜线后面的 20 是网络前缀的位数，所以这个地址的主机号是 12 位）。全 0 和全 1 的主机号地址一般不使用。</p>
<p>其他记法：10/10=10.0.0.0/10=0000101000 * 星号之前是网络前缀。</p>
</blockquote>
</li>
<li>
<p>Route aggregation（路由聚合）</p>
<blockquote>
<p>一个 CIDR 地址块可以表示很多地址，这种地址的聚合常称为<strong>路由聚合</strong>，它使得路由表中的一个项目可以表示很多个（例如上千个）原来传统分类地址的路由。</p>
<p>路由聚合也称为<strong>构成超网</strong> (supernetting)。</p>
<p>CIDR 虽然不使用子网了，但仍然使用 “掩码” 这一名词（但不叫子网掩码）。</p>
<p>对于 /20 地址块，它的掩码是 20 个连续的 1。 斜线记法中的数字就是掩码中 1 的个数。</p>
<p>CIDR 地址块中的地址数一定是 2 的整数次幂。网络前缀越短，其地址块所包含的地址数就越多。而在三级结构的 IP 地址中，划分子网是使网络前缀变长。</p>
</blockquote>
</li>
<li>
<p>Longest-prefix matching</p>
<blockquote>
<p>使用 CIDR 时，路由表中的每个项目由 “网络前缀” 和 “下一跳地址” 组成。在查找路由表时可能会得到不止一个匹配结果。</p>
<p>应当从匹配结果中选择具有最长网络前缀的路由：最长前缀匹配。</p>
<p>网络前缀越长，其地址块就越小，因而路由就越具体 (more specific)</p>
<p>最长前缀匹配又称为最长匹配或最佳匹配。</p>
</blockquote>
</li>
<li>
<p>Special IP Address</p>
<blockquote>
<p><img data-src="71.png" alt="71"></p>
</blockquote>
</li>
<li>
<p>Network Address Translation (NAT)</p>
<blockquote>
<p>IP address are scarce, so we:</p>
<ul>
<li>Dynamically assign an IP address</li>
<li>The long-term solution is for the whole Internet to migrate to IPv6, which has 128-bit addresses.</li>
<li>NAT</li>
</ul>
<hr>
<p>The basic idea behind NAT is for the ISP to <strong>assign each home or business a single IP address for Internet traffic</strong>.</p>
<p>Within the customer network, every computer gets a unique IP address, which is used for routing <strong>intramural traffic</strong>. Just before a packet exits the customer network and goes to the ISP, <strong>an address translation from the unique internal IP address to the shared public IP address</strong> takes place.</p>
<p>So there are three reserved ranges, No packets containing these addresses may appear on the Internet, they are for intramural customer network:</p>
<ul>
<li>10.0.0.0-10.255.255.255/8</li>
<li>172.16.0.0-172.31.255.255/12</li>
<li>192.168.0.0-192.168.255.255/16</li>
</ul>
<p><img data-src="72.png" alt="72"></p>
<p><strong>Source port field is used in NAT to solve mapping problem.</strong></p>
<p>When a packet is entering the NAT box, the source port is extracted and used as an index into the NAT box’s mapping table.</p>
<p>From the entry located , the internal IP address and the original TCP source port are extracted and inserted into the packet.</p>
<p>Both the IP and TCP checksums are recomputed and inserted into the packet.</p>
<hr>
<p>Issues:</p>
<ul>
<li>It violates the architectural model of IP that each IP address is associated with only one machine on the Internet.</li>
<li>It changes the Internet into a “connection-oriented” network. The NAT box maintains the state of the connection, and if it crashes, so does the link.</li>
<li>Protocol layer <strong>k</strong> makes assumptions about what protocol layer <strong>k+1</strong> has put in the payload (port number), violating layer independence.</li>
<li>NAT can/may/will fail if some protocols other than TCP or UDP are used.</li>
<li>NAT break up the end-to-end connection model.</li>
<li>The limit of a NAT machine is 61,440 machines.</li>
</ul>
</blockquote>
</li>
<li>
<p>IPv6</p>
<blockquote>
<p>IPv6 fixed header:<br>
<img data-src="73.png" alt="73"></p>
<p>IPv6 extension headers:</p>
<p><img data-src="74.png" alt="74"></p>
</blockquote>
</li>
<li>
<p>Internet control Protocol</p>
<blockquote>
<p><img data-src="75.png" alt="75"></p>
</blockquote>
</li>
<li>
<p><strong>ICMP-Internet Control Message Protocol</strong></p>
<blockquote>
<p>To inform hosts and routers when things go wrong, or, to send queries to get status information.</p>
<p>The ICMP messages are encapsulated in normal IP datagrams.</p>
<p>An ICMP message includes the header of the IP datagram that caused the message to be sent.</p>
<p>Principle ICMP Message Types:</p>
<p><img data-src="76.png" alt="76"></p>
<p>为了提高 IP 数据报交付成功的机会，在网络层使用了<strong>网际控制报文协议</strong> ICMP (Internet Control Message Protocol)。ICMP 允许主机或路由器报告差错情况和提供有关异常情况的报告。ICMP 不是高层协议，而是 IP 层的协议。ICMP 报文作为 IP 层数据报的数据，加上数据报的首部，组成 IP 数据报发送出去。</p>
<hr>
<p>ICMP format：</p>
<p><img data-src="77.png" alt="77"></p>
<p>ICMP 报文的种类有两种，即 ICMP <strong>差错报告报文</strong>和 ICMP <strong>询问报文</strong>。</p>
<p>差错报告：终点不可达、 源点抑制、时间超过 、参数问题 、改变路由（重定向）</p>
<p>不发送 ICMP 差错报告报文的几种情况：</p>
<ul>
<li>对 ICMP 差错报告报文不再发送 ICMP 差错报告报文。</li>
<li>对第一个分片的数据报片的所有后续数据报片都不发送 ICMP 差错报告报文。</li>
<li>对具有多播地址的数据报都不发送 ICMP 差错报告报文。</li>
<li>对具有特殊地址（如 127.0.0.0 或 0.0.0.0）的数据报不发送 ICMP 差错报告报文。</li>
</ul>
<p>询问报文：回送请求和回答报文、时间戳请求和回答报文</p>
<hr>
<p>ICMP 应用举例：PING（Packet InterNet Groper）</p>
<p>PING 使用了 ICMP 回送请求与回送回答报文。PING 是应用层直接使用网络层 ICMP 的例子，它没有通过运输层的 TCP 或 UDP。</p>
</blockquote>
</li>
<li>
<p>ARP（The Address Resolution Protocol）</p>
<blockquote>
<p><img data-src="78.png" alt="78"></p>
<p>不管网络层使用的是什么协议，在实际网络的链路上传送数据帧时，最终还是必须使用硬件地址。</p>
<p>每一个主机都设有一个 ARP 高速缓存 (ARP cache)，里面有所在的局域网上的各主机和路由器的 IP 地址到硬件地址的映射表。</p>
<p>当主机 A 欲向本局域网上的某个主机 B 发送 IP 数据报时，就先在其 ARP 高速缓存中查看有无主机 B 的 IP 地址。如有，就可查出其对应的硬件地址，再将此硬件地址写入 MAC 帧，然后通过局域网将该 MAC 帧发往此硬件地址。</p>
<p>Q：为什么在 Router 上，分组中源 / 目标 IP 不变，而帧中的源 / 目标 MAC 要变，如何变？</p>
<p>A：因为网络层是端到端 (end-to-end) 的，而数据链路层是点到点 (point-to-point) 的，源、目标的 MAC 地址要改变，加入路由器的 MAC 地址。</p>
<p><img data-src="79.png" alt="79"></p>
<p>ARP 是解决<strong>同一个局域网</strong>上的主机或路由器的 IP 地址和硬件地址的映射问题</p>
<p>如果所要找的主机和源主机不在同一个局域网上，那么就要通过 ARP 找到一个位于本局域网上的某个路由器的硬件地址，然后把分组发送给这个路由器，让这个路由器把分组转发给下一个网络。剩下的工作就由下一个网络来做。</p>
<p>从 IP 地址到硬件地址的解析是自动进行的，主机的用户对这种地址解析过程是不知道的。</p>
<p>只要主机或路由器要和本网络上的另一个已知 IP 地址的主机或路由器进行通信，ARP 协议就会自动地将该 IP 地址解析为链路层所需要的硬件地址。</p>
</blockquote>
</li>
<li>
<p>为什么我们不能直接使用硬件地址来通信？</p>
<blockquote>
<p>由于全世界存在着各式各样的网络，它们使用不同的硬件地址。要使这些异构网络能够互相通信就必须进行非常复杂的硬件地址转换工作，因此几乎是不可能的事。</p>
<p>连接到因特网的主机都拥有统一的 IP 地址，它们之间的通信就像连接在同一个网络上那样简单方便，因为调用 ARP 来寻找某个路由器或主机的硬件地址都是由计算机软件自动进行的，对用户来说是看不见这种调用过程的。</p>
</blockquote>
</li>
<li>
<p>DHCP (Dynamic Host Configuration Protocol)</p>
<blockquote>
<p>为了将软件协议做成通用的和便于移植，协议软件的编写者<strong>把协议软件参数化</strong>。这就使得在很多台计算机上使用同一个经过编译的二进制代码成为可能。</p>
<p>在协议软件中给这些参数赋值的动作叫做<strong>协议配置</strong>。需要配置的项目:</p>
<ul>
<li>IP 地址</li>
<li>子网掩码</li>
<li>默认路由器的 IP 地址</li>
<li>域名服务器的 IP 地址</li>
</ul>
<p><strong>动态主机配置协议 DHCP</strong> 提供了即插即用连网 (plug-and-play networking) 的机制。这种机制允许一台计算机加入新的网络和获取 IP 地址而不用手工参与。</p>
<hr>
<p>n 需要 IP 地址的主机在启动时就向 DHCP 服务器广播发送发现报文（DHCPDISCOVER），这时该主机就成为 DHCP 客户。</p>
<p>本地网络上所有主机都能收到此广播报文，但只有 DHCP 服务器才回答此广播报文。</p>
<p>DHCP 服务器先在其数据库中查找该计算机的配置信息。若找到，则返回找到的信息。若找不到，则从服务器的 IP 地址池 (address pool) 中取一个地址分配给该计算机。DHCP 服务器的回答报文叫做提供报文（DHCPOFFER）。</p>
<p>并不是每个网络上都有 DHCP 服务器，这样会使 DHCP 服务器的数量太多。现在是<strong>每一个网络至少有一个 DHCP 中继代理</strong> (relay agent)，它配置了 DHCP 服务器的 IP 地址信息。</p>
<p>当 DHCP 中继代理收到主机发送的发现报文后，就以单播方式向 DHCP 服务器转发此报文，并等待其回答。收到 DHCP 服务器回答的提供报文后，DHCP 中继代理再将此提供报文发回给主机:</p>
<p><img data-src="80.png" alt="80"></p>
<p>DHCP 服务器分配给 DHCP 客户的 IP 地址的临时的，因此 DHCP 客户只能在一段有限的时间内使用这个分配到的 IP 地址。DHCP 协议称这段时间为<strong>租用期</strong>（lease period）。租用期的数值应由 DHCP 服务器自己决定，DHCP 客户也可在自己发送的报文中（例如，发现报文）提出对租用期的要求。</p>
</blockquote>
</li>
<li>
<p>Label Switching and MPLS (Multi-Protocol Label Switching)</p>
<blockquote>
<p>MPLS 通过在 Header 中增加 Label 字段：</p>
<p><img data-src="81.png" alt="81"></p>
<p>使得在传输过程中，在 MPLS 网络中只需要根据 Label 进行传输，而不需要使用 IP 地址或硬件地址：</p>
<p><img data-src="82.png" alt="82"></p>
</blockquote>
</li>
<li>
<p>OSPF(Open Shortest Path First) - An Interior Gateway Routing Protocol</p>
<p>BGP(Border Gateway Protocol) - The Exterior Gateway Routing Protocol</p>
<blockquote>
<ul>
<li>
<p><strong>Autonomous systems</strong>(AS): refer to the networks in an internetworks which are independent of each other. Internet is a collection of autonomous systems connected together by a bunch of backbones.</p>
</li>
<li>
<p>Routing in IP make a distinction between routing <em>in an autonomous system, and between autonomous systems</em>:</p>
</li>
<li>
<p>Interior Gateway Routing : Intra-AS routing is concerned with getting packets from source to destination. It should do this as best as possible (optimal routing).</p>
</li>
<li>
<p>Exterior Gateway Routing: Inter-AS routing has to deal with a lot of politics. For example, some ASes should not be traversed at all, whereas some do not accept “foreign” packets.</p>
</li>
</ul>
</blockquote>
</li>
</ol>
<h2 id="第六章-transport-layer"><a class="markdownIt-Anchor" href="#第六章-transport-layer">#</a> 第六章 Transport Layer</h2>
<ol>
<li>
<p>Elements of Transport layer</p>
<blockquote>
<ul>
<li>
<p>Process-to-process communication</p>
</li>
<li>
<p>Addressing: port numbers</p>
</li>
<li>
<p>Encapsulation and decapsulation</p>
</li>
<li>
<p>Multiplexing and demultiplexing</p>
</li>
<li>
<p>Flow control</p>
</li>
<li>
<p>Congestion control</p>
</li>
<li>
<p>Error control</p>
</li>
<li>
<p>Connectionless and connection-oriented services</p>
</li>
</ul>
</blockquote>
</li>
<li>
<p>Port numbers (Application Layer)</p>
<blockquote>
<p>Well-known ports: The ports ranging from 0 to 1023 are assigned and controlled by ICANN.</p>
<p>Registered ports: The ports ranging from 1024-49151 are not assigned or controlled by ICANN. They can only be registered with ICANN to prevent duplication.</p>
<p>Dynamic ports: The ports ranging from 49152 to 65535 are neither controlled nor registered. They can be used as temporary or private port numbers.</p>
</blockquote>
</li>
<li>
<p>socket address</p>
<blockquote>
<p>The combination of an IP address and a port number.</p>
</blockquote>
</li>
<li>
<p>Transport Service Primitives</p>
<blockquote>
<p><img data-src="83.png" alt="83"></p>
</blockquote>
</li>
<li>
<p>Socket primitives for TCP</p>
<blockquote>
<p><img data-src="84.png" alt="84"></p>
</blockquote>
</li>
<li>
<p>TPDU (Transport Protocol Data Unit)</p>
<blockquote>
<p>两个对等运输实体在通信时传送的数据单位叫作运输协议数据单元 TPDU (Transport Protocol Data Unit)。</p>
<p>TCP 传送的数据单位协议是 TCP 报文段 (segment)。</p>
<p>UDP 传送的数据单位协议是 UDP 报文或用户数据报。</p>
</blockquote>
</li>
<li>
<p>TCP &amp; UDP 比较、应用</p>
<p><img data-src="85.png" alt="85"></p>
<p><img data-src="86.png" alt="86"></p>
</li>
<li>
<p>常用端口</p>
<p><img data-src="87.png" alt="87"></p>
</li>
<li>
<p>UDP(User Datagram Protocol)</p>
<blockquote>
<p>UDP 只在 IP 的数据报服务之上增加了一些功能：</p>
<ul>
<li>复用和分用</li>
<li>差错检测</li>
</ul>
<p>特点：简单方便，但不可靠：</p>
<ul>
<li>无连接。发送数据之前不需要建立连接。</li>
<li>使用尽最大努力交付。即不保证可靠交付。</li>
<li>面向报文。UDP 一次传送和交付一个完整的报文。</li>
<li>没有拥塞控制。网络出现的拥塞不会使源主机的发送速率降低。很适合多媒体通信的要求。</li>
<li>支持一对一、一对多、多对一、多对多等交互通信。</li>
<li>首部开销小，只有 8 个字节。</li>
</ul>
<p>UDP 不会对报文拆分或合并，直接就原封不动在应用层和网络层间传输。所以需要用户自己确定高效的报文长度。</p>
<p><strong>复用</strong>：将 UDP 用户数据报组装成不同的 IP 数据报，发送到互联网。</p>
<p><strong>分用</strong>：根据 UDP 用户数据报首部中的目的端口号，将数据报分别传送到相应的端口，以便应用进程到端口读取数据。</p>
<p><img data-src="88.png" alt="88"></p>
<p>UDP 的 Header 格式（其中，伪首部并不出现在数据报中，但参与检验和的计算）：</p>
<p><img data-src="89.png" alt="89"></p>
<p>UDP 基于端口的分用：</p>
<ul>
<li>
<p>接收方 UDP 根据首部中的目的端口号，把报文通过相应的端口上交给应用进程。</p>
</li>
<li>
<p>如果接收方 UDP 发现收到的报文中的目的端口号不正确（即不存在对应于该端口号的应用进程），就丢弃该报文，并由 ICMP 发送 “端口不可达” 差错报文给发送方。</p>
</li>
</ul>
<hr>
<p>UDP 应用：</p>
<ul>
<li>UDP is suitable for a process that requires simple request-response communication with little concern for flow and error control. It is not usually used for a process such as FTP that needs to send bulk data.</li>
<li>UDP is suitable for a process with internal flow- and error-control mechanisms. For example, the Trivial File Transfer Protocol (TFTP) process includes flow and error control.</li>
<li>UDP is a suitable transport protocol for multicasting. Multicasting capability is embedded in the UDP software but not in the TCP software.</li>
<li>UDP is used for management processes such as SNMP.</li>
<li>UDP is used for some route updating protocols such as <strong>Routing Information Protocol</strong> (RIP).</li>
<li>UDP is normally used for interactive real-time applications that cannot tolerate uneven delay between sections of a received message.</li>
</ul>
</blockquote>
</li>
<li>
<p>RTP( Real-time Transport Protocol)</p>
<blockquote>
<p><img data-src="90.png" alt="90"></p>
<p>Header:</p>
<p><img data-src="91.png" alt="91"></p>
<p>注：Real-time Transport Control Protocol (RTCP) is a sister protocol of RTP. It handles feedback, synchronization, and the user interface. It does not transport any media samples.</p>
</blockquote>
</li>
<li>
<p>TCP (Transmission Control Protocol)</p>
<blockquote>
<p><strong>最主要的特点</strong>：</p>
<ul>
<li>
<p>TCP 是面向连接的运输层协议，在无连接的、不可靠的 IP 网络服务基础之上提供可靠交付的全双工通信服务。为此，在 IP 的数据报服务基础之上，增加了保证可靠性的一系列措施。</p>
</li>
<li>
<p>每一条 TCP 连接只能有两个端点 (endpoint)，每一条 TCP 连接只能是点对点的（一对一）。</p>
</li>
<li>
<p>面向字节流：TCP 中的 “流”(stream) 指的是流入或流出进程的字节序列。虽然应用程序和 TCP 的交互是一次一个数据块，但 TCP 把应用程序交下来的数据看成仅仅是一连串无结构的字节流。TCP 不保证接收方应用程序所收到的数据块和发送方应用程序所发出的数据块具有对应大小的关系。但接收方应用程序收到的字节流必须和发送方应用程序发出的字节流完全一样。</p>
</li>
</ul>
<p><img data-src="92.png" alt="92"></p>
<p>每一条 TCP 连接唯一地被通信两端的两个端点（即两个 socket）所确定:</p>
<p>TCP_connection = (IP1 : port1) + (IP2 : port2)</p>
<p>TCP 连接就是由协议软件所提供的一种抽象。TCP 连接的端点是抽象的套接字，即（IP 地址：端口号）。同一个 IP 地址可以有多个不同的 TCP 连接。同一个端口号也可以出现在多个不同的 TCP 连接中。</p>
<hr>
<p>Header 格式：</p>
<p><img data-src="93.png" alt="93"></p>
<ul>
<li>
<p>序号：占 4 字节。TCP 连接中传送的数据流中的每一个字节都有一个序号。序号字段的值则指的是本报文段所发送的数据的第一个字节的序号。</p>
</li>
<li>
<p>确认号：占 4 字节，是期望收到对方的下一个报文段的数据的第一个字节的序号。</p>
</li>
<li>
<p>数据偏移（即首部长度）：占 4 位，指出 TCP 报文段的数据起始处距离 TCP 报文段的起始处有多远。单位是 32 位字（以 4 字节为计算单位）。</p>
</li>
<li>
<p>保留：占 6 位，保留为今后使用，但目前应置为 0。</p>
</li>
<li>
<p>紧急 URG：控制位。当 URG = 1 时，表明紧急指针字段有效，告诉系统此报文段中有紧急数据，应尽快传送 (相当于高优先级的数据)。</p>
</li>
<li>
<p>确认 ACK：控制位。只有当 ACK =1 时，确认号字段才有效。当 ACK =0 时，确认号无效。</p>
</li>
<li>
<p>推送 PSH (PuSH) ：控制位。接收 TCP 收到 PSH = 1 的报文段后，就尽快（即 “推送” 向前）交付接收应用进程，而不再等到整个缓存都填满后再交付。</p>
</li>
<li>
<p>复位 RST (ReSeT) ：控制位。当 RST=1 时，表明 TCP 连接中出现严重差错（如主机崩溃或其他原因），必须释放连接，然后再重新建立运输连接。</p>
</li>
<li>
<p>同步 SYN (SYNchronization) ：控制位。</p>
</li>
</ul>
<p>同步 SYN = 1 表示这是一个连接请求或连接接受报文。</p>
<p>当 SYN = 1，ACK = 0 时，表明这是一个连接请求报文段。</p>
<p>当 SYN = 1，ACK = 1 时，表明这是一个连接接受报文段。</p>
<ul>
<li>终止 FIN (FINish) ：控制位。用来释放一个连接。</li>
</ul>
<p>FIN=1 表明此报文段的发送端的数据已发送完毕，并要求释放运输连接。</p>
<ul>
<li>
<p>窗口：占 2 字节。窗口值告诉对方：从本报文段首部中的确认号算起，接收方目前允许对方发送的数据量（以字节为单位）。记住：窗口字段明确指出了现在允许对方发送的数据量。窗口值经常在动态变化。</p>
</li>
<li>
<p>检验和：占 2 字节。检验和字段检验的范围包括首部和数据这两部分。在计算检验和时，要在 TCP 报文段的前面加上 12 字节的伪首部:</p>
</li>
</ul>
<p><img data-src="94.png" alt="94"></p>
<ul>
<li>
<p>紧急指针：占 2 字节。在 URG = 1 时，指出本报文段中的紧急数据的字节数（紧急数据结束后就是普通数据），指出了紧急数据的末尾在报文段中的位置。</p>
</li>
<li>
<p>选项：长度可变，最长可达 40 字节。</p>
</li>
<li>
<p>选项 1：最大报文段长度 MSS。(见下)</p>
</li>
<li>
<p>选项 2：窗口扩大选项：占 3 字节，其中一个字节表示移位值 S。新的窗口值位数从 16 增大到 (16 + S)，相当于把窗口值向左移动 S 位。窗口扩大选项可以在双方初始建立 TCP 连接时进行协商。</p>
</li>
<li>
<p>选项 3：时间戳：占 10 字节 = 时间戳值字段（4 字节）和时间戳回送回答字段（4 字节）。用于计算往返时间 RTT，防止序号绕回 PAWS (Protect Against Wrapped Sequence numbers)。序号重复时，为了使接收方能够把新报文段和迟到很久的旧报文段区分开，可以在报文段中加上时间戳。</p>
</li>
<li>
<p>填充：使整个 TCP 首部长度是 4 字节的整数倍。</p>
</li>
</ul>
<hr>
<p>TCP 并没有要求使用的 ARQ 究竟是 Go-Back-N，Selective Repeat，也没有要求窗口大小。这都取决于软件开发者。但是 TCP 要求接收方必须有累积确认的功能，以减小传输开销。接收方可以在合适的时候发送确认，也可以在自己有数据要发送时把确认信息顺便捎带上。但接收方不应过分推迟发送确认，否则会导致发送方不必要的重传，捎带确认实际上并不经常发生。</p>
<p>关于超时重传，TCP 采用了一种自适应算法，它记录一个报文段发出的时间，以及收到相应确认的时间。这两个时间之差就是报文段的往返时间 RTT。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mi>T</mi><mi>T</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mi>α</mi><mi>R</mi><mi>T</mi><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">RTT=(1-\alpha)RTT+\alpha RTT&#x27;
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.801892em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">RTT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> 是一个长期的统计量，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">RTT&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 是这次传输完了一个报文后，测得的它的 RTT。这样在长时间的发送和迭代中，就可以得到一个相对准确的 RTT 估计值。RFC6298 推荐<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">\alpha=1/8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">8</span></span></span></span>。而超时重传的时间<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>O</mi></mrow><annotation encoding="application/x-tex">RTO</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span> 应该略大于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">RTT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>。RFC6298 建议<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>O</mi><mo>=</mo><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mn>4</mn><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">RTO=RTT+4RTT_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub></mrow><annotation encoding="application/x-tex">RTT_D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是 RTT 偏差的加权平均值:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mi>R</mi><mi>T</mi><msub><mi>T</mi><mi>D</mi></msub><mo>+</mo><mi>β</mi><mi mathvariant="normal">∣</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>−</mo><mi>R</mi><mi>T</mi><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">RTT_D=(1-\beta)RTT_D+\beta|RTT-RTT&#x27;|
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p>
<p>推荐值<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">\beta=1/4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord">4</span></span></span></span>。</p>
<p>修正的<strong> Karn 算法</strong>：报文段每重传一次，就把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>O</mi></mrow><annotation encoding="application/x-tex">RTO</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span> 翻倍。当不再发生重传时，再设回<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>T</mi><mi>O</mi><mo>=</mo><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mn>4</mn><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">RTO=RTT+4RTT+D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>。</p>
<hr>
<p>如果接收方返回的报文中，窗口值为 0 了，此时发送方无法发送任何数据。会导致卡死在这里。事实上，发送方探测到<strong>零窗口通知</strong>时，就会启动一个持续计时器，计时器到期就发送一个<strong>零窗口探测报文段</strong>（仅携带 1 字节的数据）, 接收方需要确认这个报文段并给出当前窗口值。</p>
<hr>
<p>如何控制 TCP 发送报文段的时机仍然是一个较为复杂的问题。现有三种机制：</p>
<ul>
<li>
<p>TCP 维持一个变量，它等于最大报文段长度 MSS。只要缓存中存放的数据达到 MSS 字节时，就组装成一个 TCP 报文段发送出去。</p>
</li>
<li>
<p>由发送方的应用进程指明要求发送报文段，即 TCP 支持的推送 (push) 操作。</p>
</li>
<li>
<p>发送方的一个计时器期限到了，这时就把当前已有的缓存数据装入报文段（但长度不能超过 MSS）发送出去。</p>
</li>
</ul>
<p><strong>糊涂窗口综合症</strong>：每次仅发送一个字节或很少几个字节的数据时，有效数据传输效率变得很低的现象。（解决方法：Nagle 算法）</p>
<hr>
<p><strong>拥塞控制</strong>：</p>
<p>Q：增加资源能解决拥塞吗？</p>
<p>A：不能，而且还可能使网络的性能更坏。</p>
<ul>
<li>
<p>拥塞控制的前提：网络能够承受现有的网络负荷。</p>
</li>
<li>
<p>实践证明，拥塞控制是很难设计的，因为它是一个动态问题。</p>
</li>
<li>
<p>分组的丢失是网络发生拥塞的征兆，而不是原因。</p>
</li>
<li>
<p>在许多情况下，甚至正是拥塞控制本身成为引起网络性能恶化、甚至发生死锁的原因。</p>
</li>
</ul>
<p>采用检测 - 传送 - 调整的闭环控制措施。</p>
<ul>
<li>检测：监测网络系统，检测拥塞在何时、何处发生。主要指标有：</li>
</ul>
<p>1. 由于缺少缓存空间而被丢弃的分组的百分数；</p>
<p>2. 平均队列长度；</p>
<p>3. 超时重传的分组数；</p>
<p>4. 平均分组时延；</p>
<p>5. 分组时延的标准差，等等。</p>
<p>这些指标的上升都标志着拥塞的增长</p>
<ul>
<li>传送：将拥塞发生的信息传送到可采取行动的地方。</li>
</ul>
<p>1. 将拥塞发生的信息传送到产生分组的源站。</p>
<p>2. 在路由器转发的分组中保留一个比特或字段，用该比特或字段的值表示网络没有拥塞或产生了拥塞。</p>
<p>3. 周期性地发出探测分组等。</p>
<ul>
<li>调整：调整网络系统的运行以解决出现的问题。</li>
</ul>
<p>过于频繁，会使系统产生不稳定的振荡。</p>
<p>过于迟缓，不具有任何实用价值。</p>
<p>选择正确的时间常数是相当困难的。</p>
<p>TCP 采用基于滑动窗口的方法进行拥塞控制，属于闭环控制方法。TCP 发送方维持一个拥塞窗口 cwnd (Congestion Window)，拥塞窗口的大小取决于网络的拥塞程度，并且是动态变化的。</p>
<p>真正的发送窗口值 = min（接收方通知的窗口值，拥塞窗口值）</p>
<p><strong>四种拥塞控制算法</strong>（ RFC 5681） ：</p>
<ul>
<li><strong>慢开始</strong> (slow-start)：由小到大逐渐增大注入到网络中的数据字节，即：由小到大逐渐增大拥塞窗口数值。在每收到一个对新的报文段的确认，就把拥塞窗口增加最多一个发送方的最大报文段 Sender MSS。</li>
<li><strong>拥塞避免</strong> (congestion avoidance)：每经过一个往返时间 RTT（不管在此期间收到了多少确认），发送方的拥塞窗口 cwnd = cwnd + 1。使拥塞窗口 cwnd 按线性规律缓慢增长。</li>
</ul>
<p>如果发送方判断网络拥塞，就 ssthresh=max (cwnd/2, 2)。cwnd&lt;=ssthresh 时使用慢开始，否则用拥塞避免：</p>
<p><img data-src="95.png" alt="95"></p>
<ul>
<li>
<p>快重传 (fast retransmit): 发送方只要连续收到三个重复的确认，就立即进行重传（即 “快重传”），这样就不会出现超时。快重传算法要求接收方立即发送确认，即使收到了失序的报文段，也要立即发出对已收到的报文段的重复确认。</p>
</li>
<li>
<p>快恢复 (fast recovery):  当发送端收到连续三个重复的确认时，不执行慢开始算法，而是执行快恢复算法 FR (Fast Recovery) 算法：</p>
</li>
</ul>
<p>1. 慢开始门限 ssthresh = 当前拥塞窗口 cwnd / 2 ；</p>
<p>2. 乘法减小 MD (Multiplicative Decrease) 拥塞窗口。</p>
<pre><code>新拥塞窗口 cwnd = 慢开始门限 ssthresh ；
</code></pre>
<p>执行拥塞避免算法，使拥塞窗口缓慢地线性增大。</p>
<p><img data-src="96.png" alt="96"></p>
<hr>
<p>l 对 TCP 拥塞控制影响最大的就是路由器的<strong>分组丢弃策略</strong>:</p>
<ul>
<li>
<p>尾部丢弃策略 (tail-drop policy)：当队列已满时，以后到达的所有分组（如果能够继续排队，这些分组都将排在队列的尾部）将都被丢弃。</p>
</li>
<li>
<p>路由器的尾部丢弃往往会导致一连串分组的丢失，这就使发送方出现超时重传，使 TCP 进入拥塞控制的慢开始状态，结果使 TCP 连接的发送方突然把数据的发送速率降低到很小的数值。</p>
</li>
</ul>
<p>解决方案：<strong>主动队列管理 AQM</strong>：</p>
<ul>
<li>主动：不要等到路由器的队列长度已经达到最大值时才不得不丢弃后面到达的分组，而是在队列长度达到某个值得警惕的数值时（即当网络拥塞有了某些拥塞征兆时），就主动丢弃到达的分组。</li>
</ul>
<p>AQM 可以有不同实现方法，其中曾流行多年的就是<strong>随机早期检测 RED</strong> (Random Early Detection)。</p>
<p>多年的实践证明，RED 的使用效果并不太理想。AQM 实际上就是对路由器中的分组排队进行智能管理，而不是简单地把队列的尾部丢弃。</p>
<hr>
<p>TCP 连接建立过程中要解决的三个问题</p>
<ul>
<li>要使每一方能够确知对方的存在。</li>
<li>要允许双方协商一些参数（如最大窗口值、是否使用窗口扩大选项和时间戳选项以及服务质量等）。</li>
<li>能够对运输实体资源（如缓存大小、连接表中的项目等）进行分配</li>
</ul>
<p>TCP 建立连接的过程叫做握手。采用三报文握手：在客户和服务器之间交换三个 TCP 报文段，以防止已失效的连接请求报文段突然又传送到了，因而产生 TCP 连接建立错误：</p>
<p><img data-src="97.png" alt="97"></p>
<p>TCP 连接释放过程比较复杂。数据传输结束后，通信的双方都可释放连接。TCP 连接释放过程是四报文握手：</p>
<p><img data-src="98.png" alt="98"></p>
<p>最后还要等待 2MSL（Maximum Segment Lifetime）是因为要 l 保证发送的最后一个 ACK 报文段能够到达 B，要防止 “已失效的连接请求报文段” 出现在本连接中。</p>
<hr>
<p>TCP 有限状态自动机：</p>
<p><img data-src="99.png" alt="99"></p>
</blockquote>
</li>
<li>
<p>MSS (Maximum Segment Size)</p>
<blockquote>
<p>是 TCP 报文段中的数据字段的最大长度。</p>
<p>数据字段加上 TCP 首部才等于整个的 TCP 报文段。</p>
<p>所以，MSS 是 “TCP 报文段长度减去 TCP 首部长度”。</p>
<p>默认值为 536 bytes，所以 TCP 报文段长度为 536+20=556 bytes，IP 数据包长度为 556+20=576 bytes。</p>
</blockquote>
</li>
<li>
<p>Socket 的意思：</p>
<blockquote>
<ul>
<li>
<p>应用编程接口 API 称为 socket API, 简称为 socket。</p>
</li>
<li>
<p>socket API 中使用的一个函数名也叫作 socket。</p>
</li>
<li>
<p>调用 socket 函数的端点称为 socket。</p>
</li>
<li>
<p>调用 socket 函数时其返回值称为 socket 描述符，可简称为 socket。</p>
</li>
<li>
<p>在操作系统内核中连网协议的 Berkeley 实现，称为 socket 实现。</p>
</li>
</ul>
</blockquote>
</li>
</ol>

  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2025-03-30 09:07:08" itemprop="dateModified" datetime="2025-03-30T09:07:08+08:00">2025-03-30</time>
  </span>
  <span id="2023/02/14/计算机网络/" class="item leancloud_visitors" data-flag-title="计算机网络" title="Views">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">Views</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">times</span>
  </span>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>SuBonan <i class="ic i-at"><em>@</em></i>やがて、平凡な人になる
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="http://sugarsbn.github.io/2023/02/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" title="计算机网络">http://sugarsbn.github.io/2023/02/14/计算机网络/</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/02/11/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E7%9A%84%E4%BC%98%E5%8C%96/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;i.imgtg.com&#x2F;2023&#x2F;01&#x2F;12&#x2F;Q5dWs.jpg" title="汇编语言乱七八糟的优化">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> - 计算机基础</span>
  <h3>汇编语言乱七八糟的优化</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2023/03/08/%E9%87%8F%E5%AD%90%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%E3%80%81%E9%9A%90%E5%90%AB%E5%AD%90%E7%BE%A4%E5%92%8C%E7%89%B9%E5%BE%81%E6%A0%87/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;i.imgtg.com&#x2F;2023&#x2F;01&#x2F;12&#x2F;Q5foS.jpg" title="量子傅里叶变换、隐含子群和特征标">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> - 量子计算</span>
  <h3>量子傅里叶变换、隐含子群和特征标</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0"><span class="toc-number">1.</span> <span class="toc-text"> 第一章</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-physical-layer"><span class="toc-number">2.</span> <span class="toc-text"> 第二章 Physical Layer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-data-link-layer"><span class="toc-number">3.</span> <span class="toc-text"> 第三章 Data Link Layer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-medium-access-control-sublayer"><span class="toc-number">4.</span> <span class="toc-text"> 第四章 Medium Access Control Sublayer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-the-network-layer"><span class="toc-number">5.</span> <span class="toc-text"> 第五章 The Network Layer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-transport-layer"><span class="toc-number">6.</span> <span class="toc-text"> 第六章 Transport Layer</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
        <ul>
          <li><a href="/2020/10/06/%E5%85%B3%E4%BA%8Ejava%E5%9F%9F%E5%92%8C%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E4%B8%8D%E6%94%AF%E6%8C%81%E5%A4%9A%E6%80%81%E5%AF%BC%E8%87%B4%E7%9A%84%E7%BC%BA%E9%99%B7/" rel="bookmark" title="关于java域和静态方法不支持多态导致的缺陷">关于java域和静态方法不支持多态导致的缺陷</a></li><li><a href="/2020/11/23/%E5%9F%BA%E6%95%B0%E6%8E%92%E5%BA%8F/" rel="bookmark" title="基数排序">基数排序</a></li><li><a href="/2021/06/09/C%20C++%20%E8%AF%AD%E6%B3%95/" rel="bookmark" title="C-C++语法">C-C++语法</a></li><li><a href="/2021/10/20/%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%AF%AD%E8%A8%80/" rel="bookmark" title="类型和程序设计语言">类型和程序设计语言</a></li><li><a href="/2021/11/02/%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%AF%AD%E8%A8%80-%E7%BB%AD/" rel="bookmark" title="类型和程序设计语言_续">类型和程序设计语言_续</a></li><li><a href="/2022/03/15/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="bookmark" title="操作系统">操作系统</a></li><li><a href="/2022/04/21/linker-symtable/" rel="bookmark" title="链接（基于x86-64下标准ELF格式）">链接（基于x86-64下标准ELF格式）</a></li><li><a href="/2022/08/28/%E5%85%B3%E4%BA%8EHaskell%E5%AF%B9Kmeans%E7%AE%97%E6%B3%95parallel%E5%B9%B6%E8%A1%8C%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/" rel="bookmark" title="关于Haskell对Kmeans算法parallel并行实现的注释">关于Haskell对Kmeans算法parallel并行实现的注释</a></li><li><a href="/2023/01/05/C-%E6%95%B0%E7%BB%84/" rel="bookmark" title="C++中数组和内存分布">C++中数组和内存分布</a></li><li><a href="/2023/01/11/Machine-Learning/" rel="bookmark" title="Machine Learning 机器学习">Machine Learning 机器学习</a></li><li><a href="/2023/01/14/%E5%9B%BE%E5%BD%A2%E5%AD%A6%E4%B8%AD%E7%9A%84%E7%9F%A9%E9%98%B5%E5%90%AB%E4%B9%89/" rel="bookmark" title="图形学中的矩阵含义">图形学中的矩阵含义</a></li><li><a href="/2023/02/01/%E7%82%B9%E7%BA%BF%E9%9D%A2%E7%9A%84%E6%8F%92%E5%80%BC/" rel="bookmark" title="点线面的插值">点线面的插值</a></li><li><a href="/2023/02/11/%E5%85%89%E7%85%A7%E6%A8%A1%E5%9E%8B/" rel="bookmark" title="光照模型">光照模型</a></li><li><a href="/2023/02/11/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E7%9A%84%E4%BC%98%E5%8C%96/" rel="bookmark" title="汇编语言乱七八糟的优化">汇编语言乱七八糟的优化</a></li><li class="active"><a href="/2023/02/14/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="bookmark" title="计算机网络">计算机网络</a></li><li><a href="/2023/06/14/Database/" rel="bookmark" title="Introduction to Database">Introduction to Database</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="SuBonan"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">SuBonan</p>
  <div class="description" itemprop="description">やがて、平凡な人になる <br><a target="_blank" rel="noopener" href="http://www.subonan.com/computer-graphics"> 图形学作业请点这里 </a></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">126</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">10</span>
        <span class="name">categories</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL1N1Z2FyU0JO" title="https:&#x2F;&#x2F;github.com&#x2F;SugarSBN"><i class="ic i-github"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2023/02/11/%E4%B9%B1%E4%B8%83%E5%85%AB%E7%B3%9F%E7%9A%84%E4%BC%98%E5%8C%96/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2023/03/08/%E9%87%8F%E5%AD%90%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%E3%80%81%E9%9A%90%E5%90%AB%E5%AD%90%E7%BE%A4%E5%92%8C%E7%89%B9%E5%BE%81%E6%A0%87/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%95%B0%E5%AD%A6%E6%9D%82%E8%AE%B0/" title="In - 数学杂记">- 数学杂记</a>
</div>

    <span><a href="/2023/12/03/linear-logic-and-algebra/" title="Something About Linear Logic">Something About Linear Logic</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E7%BB%98%E7%94%BB/" title="In - 绘画">- 绘画</a>
</div>

    <span><a href="/2021/01/23/%E4%B9%B1%E6%B6%82%E4%B9%B1%E7%94%BB/" title="絵">絵</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%9D%82%E6%84%9F/" title="In - 杂感">- 杂感</a>
</div>

    <span><a href="/2020/03/08/%E6%86%8B%E5%87%BA%E6%9D%A5%E7%9A%84%E5%BA%9F%E8%AF%9D/" title="憋出来的废话">憋出来的废话</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" title="In - 计算机基础">- 计算机基础</a>
</div>

    <span><a href="/2021/06/09/C%20C++%20%E8%AF%AD%E6%B3%95/" title="C-C++语法">C-C++语法</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%95%B0%E5%AD%A6%E6%9D%82%E8%AE%B0/" title="In - 数学杂记">- 数学杂记</a>
</div>

    <span><a href="/2021/06/22/%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90%EF%BC%88%E4%B8%8B%EF%BC%89/" title="数学分析（下）">数学分析（下）</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%95%B0%E5%AD%A6%E6%9D%82%E8%AE%B0/" title="In - 数学杂记">- 数学杂记</a>
</div>

    <span><a href="/2022/11/01/%E8%BF%90%E7%AD%B9%E5%AD%A6/" title="运筹学">运筹学</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E9%87%8F%E5%AD%90%E8%AE%A1%E7%AE%97/" title="In - 量子计算">- 量子计算</a>
</div>

    <span><a href="/2023/11/07/quantum-random-walk/" title="Quantum Random Walk">Quantum Random Walk</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%95%B0%E5%AD%A6%E6%9D%82%E8%AE%B0/" title="In - 数学杂记">- 数学杂记</a>
</div>

    <span><a href="/2023/04/27/%E5%A4%8D%E6%9D%82%E6%80%A7%E8%AF%81%E6%98%8E%E6%8A%80%E5%B7%A7/" title="Complexity Theory中一些基础定理的证明">Complexity Theory中一些基础定理的证明</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E6%96%87%E7%8C%AE%E9%98%85%E8%AF%BB/" title="In - 文献阅读">- 文献阅读</a>
</div>

    <span><a href="/2023/06/26/communication-complexity-and-lower-bounds/" title="Communication Complexity and Lower Bounds for Streaming Algorithm">Communication Complexity and Lower Bounds for Streaming Algorithm</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E9%87%8F%E5%AD%90%E8%AE%A1%E7%AE%97/" title="In - 量子计算">- 量子计算</a>
</div>

    <span><a href="/2021/08/20/%E9%87%8F%E5%AD%90%E6%90%9C%E7%B4%A2/" title="量子搜索">量子搜索</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">SuBonan @ SuBonan</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2023/02/14/计算机网络/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,copy_tex: true,
    katex: true,fancybox: true,copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
